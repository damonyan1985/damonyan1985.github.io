/*! For license information please see index.min.js.LICENSE.txt */
(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,"string");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}var a="canvas",u=function(){function e(){n(this,e)}return i(e,null,[{key:"getUrlParams",value:function(){}},{key:"remToPx",value:function(e){return 12*e}},{key:"objToStyle",value:function(e,t){if(t instanceof Object){var n=e.style;for(var o in t)n[o]=t[o]}}},{key:"asyncTask",value:function(e){var t=e.macroTask,n=e.duration,o=void 0===n?0:n,i=e.completed,r=e.fail,a=setTimeout((function(){try{var e=t();window.clearTimeout(a),i&&i(e)}catch(e){console.error("asyncTask error: ",e),r&&r(e)}}),o)}},{key:"asyncTaskPromise",value:function(t){var n=t.macroTask,o=t.duration,i=void 0===o?0:o;return new Promise((function(t,o){e.asyncTask({macroTask:n,duration:i,completed:function(e){t(e)},fail:function(e){o(e)}})}))}},{key:"measureText",value:function(e,t){var n=document.createElement(a).getContext("2d");return n.font=t,n.measureText(e).width}}]),e}();t(u,"timeFormat",(function(e){var t=parseInt(e/60),n=parseInt(e%60);return(t<10?"0"+t:t)+":"+(n<10?"0"+n:n)})),Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1},Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)},String.format=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))};var s=window.AudioContext||window.webkitAudioContext,l=i((function e(){n(this,e)}));function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function d(e,t,n){return(t=x(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},f.apply(this,arguments)}function h(){h=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var r=t&&t.prototype instanceof y?t:y,a=Object.create(r.prototype),u=new L(i||[]);return o(a,"_invoke",{value:P(e,n,u)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function y(){}function p(){}function v(){}var m={};s(m,r,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(T([])));b&&b!==t&&n.call(b,r)&&(m=b);var w=v.prototype=y.prototype=Object.create(m);function k(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function i(o,r,a,u){var s=d(e[o],e,r);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==c(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){i("next",e,a,u)}),(function(e){i("throw",e,a,u)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,u)}))}u(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){i(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function P(e,t,n){var o="suspendedStart";return function(i,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===i)throw r;return{value:void 0,done:!0}}for(n.method=i,n.arg=r;;){var a=n.delegate;if(a){var u=_(a,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=d(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=d(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function T(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return p.prototype=v,o(w,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:p,configurable:!0}),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},k(x.prototype),s(x.prototype,a,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,o,i,r){void 0===r&&(r=Promise);var a=new x(l(t,n,o,i),r);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(w),s(w,u,"Generator"),s(w,r,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return a.type="throw",a.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var u=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(u&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(u){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var i=o.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}function y(e,t,n,o,i,r,a){try{var u=e[r](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(o,i)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,x(o.key),o)}}function k(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function x(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===c(t)?t:String(t)}t(l,"USE_STATE",!0),t(l,"USE_STATE_UI_UPDATE",!1);var P=function(){function e(t){var n=t.styleName,o=void 0===n?"":n,i=t.id,r=void 0===i?"":i,a=t.onready,u=void 0===a?void 0:a;b(this,e),this.styleName=o,this.id=r,this.onready=u}return k(e,[{key:"initWidget",value:function(){}},{key:"disposeWidget",value:function(){if(this.isContainer()&&this.children)for(var e=0;e<this.children.length;e++)this.children[e].disposeWidget();else this.isComponent()&&this.child&&this.child.disposeWidget()}},{key:"build",value:function(){return this}},{key:"isContainer",value:function(){return!1}},{key:"render",value:function(){return this.elem=this._render(),this.onready&&this.elem&&this.onready(this),this.elem}},{key:"_render",value:function(){return this.isComponent()?this.build().render():null}},{key:"isComponent",value:function(){return!1}},{key:"classType",value:function(){return this.constructor}}]),e}(),_=function(e){p(n,e);var t=m(n);function n(e){var o=e.styleName,i=e.id,r=void 0===i?"":i,a=e.onready,u=void 0===a?void 0:a;return b(this,n),t.call(this,{styleName:o,id:r,onready:u})}return k(n,[{key:"isComponent",value:function(){return!0}},{key:"rebuild",value:function(){return this.child=this.build(),this.child}},{key:"_render",value:function(){return this.child||(this.initWidget(),this.child=this.build()),this.child.render()}}]),n}(P),S=function(e){p(i,e);var t,n,o=m(i);function i(e){var t,n=e.styleName,r=e.onready,a=void 0===r?void 0:r;return b(this,i),(t=o.call(this,{styleName:n,onready:a})).state={},t}return k(i,[{key:"rebuild",value:function(){return this.child=this.build(),this.child}},{key:"isComponent",value:function(){return!0}},{key:"setStateAsync",value:(t=h().mark((function e(t,n){var o=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.asyncTaskPromise({macroTask:function(){o.setState(t)}});case 2:n&&n();case 3:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function a(e){y(r,o,i,a,u,"next",e)}function u(e){y(r,o,i,a,u,"throw",e)}a(void 0)}))},function(e,t){return n.apply(this,arguments)})},{key:"setState",value:function(e){if(l.USE_STATE){this.state=e;var t=V.deepCloneWidget(this);new V(this,t).diff()}else if(l.USE_STATE_UI_UPDATE){var n;this.state=e,console.log("BoyiaStateWidget setState parent = "+(this.node&&this.node.parentNode?this.node.parentNode:null)),this.node&&this.node.parentNode&&(n=this.node.parentNode).removeChild(this.node),V.rebuild(this),this.render(),this.node&&n&&n.appendChild(this.node)}}},{key:"_render",value:function(){return this.child||(this.initWidget(),this.child=this.build()),this.child&&(this.node=this.child.render()),this.node}}]),i}(P),C=function(e){p(n,e);var t=m(n);function n(e){var o,i=e.id,r=void 0===i?"":i,a=e.styleName,u=void 0===a?"":a,s=e.style,l=void 0===s?void 0:s,c=e.children,d=void 0===c?[]:c,f=e.onready,h=void 0===f?void 0:f;if(b(this,n),o=t.call(this,{styleName:u,id:r,onready:h}),!(d instanceof Array))throw new Error("children is not a chilren");return o.children=d,o.style=l,o}return k(n,[{key:"width",value:function(){return this.elem?this.elem.clientWidth:0}},{key:"height",value:function(){return this.elem?this.elem.clientHeight:0}},{key:"setWidth",value:function(e){this.elem&&(this.elem.style.width=e)}},{key:"setStyle",value:function(e){this.elem&&(this.elem.className=e)}},{key:"setCursor",value:function(e){this.elem&&(this.elem.style.cursor=e)}},{key:"setTop",value:function(e){this.elem&&(this.elem.style.top=e)}},{key:"setLeft",value:function(e){this.elem&&(this.elem.style.left=e)}},{key:"offsetLeft",value:function(){return this.elem?this.elem.offsetLeft:0}},{key:"offsetTop",value:function(){return this.elem?this.elem.offsetTop:0}},{key:"offsetWidth",value:function(){return this.elem?this.elem.offsetWidth:0}},{key:"offsetHeight",value:function(){return this.elem?this.elem.offsetHeight:0}},{key:"getBoundingClientRect",value:function(){return this.elem?this.elem.getBoundingClientRect():null}},{key:"setScrollTop",value:function(e){this.elem&&(this.elem.scrollHeight<=this.elem.clientHeight+this.elem.scrollTop||(this.elem.scrollTop=this.elem.scrollTop+e))}},{key:"scrollBy",value:function(e){this.elem&&(this.elem.scrollHeight<=this.elem.clientHeight+this.elem.scrollTop||this.elem&&this.elem.scrollBy({left:0,top:e,behavior:"smooth"}))}},{key:"scrollTo",value:function(e){this.elem&&(this.elem.scrollHeight<=this.elem.clientHeight+this.elem.scrollTop||this.elem&&this.elem.scrollTo({left:0,top:e,behavior:"smooth"}))}},{key:"isContainer",value:function(){return!0}},{key:"_render",value:function(){var e=document.createElement("div");return this.id&&e.setAttribute("id",this.id),this.styleName&&(e.className=this.styleName),this.style&&u.objToStyle(e,this.style),this.children.forEach((function(t){try{e.appendChild(t.render())}catch(e){console.error("appendChild err:",e),console.log("child class: "+t.constructor.name)}})),e}}]),n}(P),L=function(e){p(n,e);var t=m(n);function n(e){var o,i=e.styleName,r=e.url,a=e.id,u=void 0===a?"":a,s=e.onready,l=void 0===s?void 0:s;return b(this,n),(o=t.call(this,{styleName:i,id:u,onready:l})).url=r,o}return k(n,[{key:"setImageUrl",value:function(e){this.url=e,this.elem&&(this.elem.src=this.url)}},{key:"_render",value:function(){var e=document.createElement("img");return e.src=this.url,this.styleName&&(e.className=this.styleName),e}}]),n}(P),T=function(e){p(n,e);var t=m(n);function n(e){var o,i=e.styleName,r=e.id,a=void 0===r?"":r,u=e.name,s=void 0===u?"":u,l=e.value,c=void 0===l?"":l,d=e.onready,f=void 0===d?void 0:d,h=e.onChange;return b(this,n),(o=t.call(this,{styleName:i,id:a,onready:f})).name=s,o.value=c,o.onChange=h,o}return k(n,[{key:"type",value:function(){return""}},{key:"_render",value:function(){var e=this,t=document.createElement("input");return t.setAttribute("type",this.type()),t.setAttribute("name",this.name),t.setAttribute("value",this.value),this.onChange&&(t.onchange=function(){e.onChange(t.value)}),this.styleName&&(t.className=this.styleName),t}}]),n}(P),O=function(e){p(n,e);var t=m(n);function n(e){var o,i=e.styleName,r=void 0===i?"":i,a=e.id,u=void 0===a?"":a,s=e.name,l=void 0===s?"":s,c=e.value,d=void 0===c?"":c,f=e.onClick,h=e.onready,y=void 0===h?void 0:h;return b(this,n),(o=t.call(this,{styleName:r,id:u,name:l,value:d,onready:y})).onClick=f,o}return k(n,[{key:"type",value:function(){return"checkbox"}},{key:"checked",value:function(){return!!this.elem&&this.elem.checked}},{key:"_render",value:function(){var e=f(g(n.prototype),"_render",this).call(this);return this.onClick&&(e.onclick=this.onClick),this.id&&(e.id=this.id),e}}]),n}(T),N=function(e){p(n,e);var t=m(n);function n(e){var o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return b(this,n),(o=t.call(this,{styleName:"",id:"",onready:i})).text=e,o}return k(n,[{key:"setText",value:function(e){this.elem&&(this.elem.textContent=e)}},{key:"_render",value:function(){return document.createTextNode(this.text)}}]),n}(P),j=function(e){p(n,e);var t=m(n);function n(e){var o,i=e.oncanplay,r=e.onplay,a=e.onended,u=e.onprogress,s=e.ontimeupdate,l=e.onready;return b(this,n),(o=t.call(this,{styleName:"",id:"",onready:l})).oncanplay=i,o.onplay=r,o.onended=a,o.onprogress=u,o.ontimeupdate=s,o}return k(n,[{key:"seekTo",value:function(e){this.elem&&(this.elem.currentTime=e*this.elem.duration)}},{key:"currentTime",value:function(){return this.elem&&this.elem.currentTime}},{key:"duration",value:function(){return this.elem&&this.elem.duration}},{key:"hasUrl",value:function(){return this.elem&&this.elem.src}},{key:"setPlayUrl",value:function(e){this.elem&&(this.elem.src=e)}},{key:"play",value:function(){this.elem&&this.elem.play()}},{key:"pause",value:function(){this.elem&&this.elem.pause()}},{key:"setVolume",value:function(e){this.elem&&(this.elem.volume=e)}},{key:"_render",value:function(){var e=document.createElement("audio");return e.setAttribute("preload","auto"),e.oncanplay=function(){console.log("on audio prepared duration="+e.duration)},e.onplay=this.onplay,e.onended=this.onended,e.onprogress=this.onprogress,e.ontimeupdate=this.ontimeupdate,e.onerror=e.onended,this.elem=e,this.onready&&this.onready(this),e}}]),n}(P),E=function(e){p(n,e);var t=m(n);function n(e){var o,i=e.forId,r=e.styleName;return b(this,n),(o=t.call(this,{styleName:r,id:""})).forId=i,o}return k(n,[{key:"_render",value:function(){var e=document.createElement("label");return this.forId&&e.setAttribute("for",this.forId),this.styleName&&(e.className=this.styleName),e}}]),n}(P),I=function(e){p(n,e);var t=m(n);function n(e){var o,i=e.onTap,r=void 0===i?void 0:i,a=e.onHover,u=void 0===a?void 0:a,s=e.onTouchStart,l=void 0===s?void 0:s,c=e.onTouchEnd,d=void 0===c?void 0:c,f=e.onMouseDown,h=void 0===f?void 0:f,y=e.onMouseUp,p=void 0===y?void 0:y,v=e.child;return b(this,n),(o=t.call(this,{styleName:"",id:""})).onTap=r,o.onHover=u,o.child=v,o.onTouchStart=l,o.onTouchEnd=d,o.onMouseDown=h,o.onMouseUp=p,o}return k(n,[{key:"build",value:function(){return this.child}},{key:"_render",value:function(){var e=this.child.render();return this.onTap&&(e.onclick=this.onTap),this.onHover&&(e.onmouseover=this.onHover),this.onMouseDown&&(e.onmousedown=this.onMouseDown),this.onMouseUp&&(e.onmouseup=this.onMouseUp),this.onTouchStart&&(e.ontouchstart=this.onTouchStart),this.onTouchEnd&&(e.ontouchend=this.onTouchEnd),e}}]),n}(_),B=function(e){p(n,e);var t=m(n);function n(e){var o,i=e.width,r=e.height,a=e.onready,u=void 0===a?void 0:a;return b(this,n),(o=t.call(this,{styleName:"",id:"",onready:u})).width=i,o.height=r,o}return k(n,[{key:"setCanvasSize",value:function(e,t){this.width=e,this.height=t,this.elem&&(this.elem.width=this.width,this.elem.height=this.height)}},{key:"imageData",value:function(){return this.context?this.context.getImageData(0,0,this.width,this.height):null}},{key:"putImageData",value:function(e,t,n){this.context&&this.context.putImageData(e,t,n)}},{key:"_render",value:function(){var e=document.createElement(a);return e.width=this.width,e.height=this.height,this.context=e.getContext("2d"),e}}]),n}(P),M=function(){function e(){b(this,e)}return k(e,null,[{key:"init",value:function(){e._root=document.getElementById("root"),window.onpopstate=function(t){console.log("onpopstate e = ",t.state),e.pop()}}},{key:"push",value:function(t){var n=t.page,o=t.path,i=t.title;if(e._root&&n){var r=n();if(r instanceof P){e._stack.push(r);var a=e._root;e._removeAll(e._root),a.appendChild(r.render()),history.pushState({title:i,path:o},i,o)}}}},{key:"_removeAll",value:function(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild)}},{key:"pop",value:function(){if(e._root&&!(e._stack.length<=1)){var t=e._root;e._removeAll(t);var n=e._stack,o=n.splice(n.length-1,1);if(o)for(var i=0;i<o.length;i++)o[i].disposeWidget();n.length>0&&t.appendChild(n[n.length-1].render())}}},{key:"replace",value:function(t){var n=t.page,o=t.path,i=t.title;if(0==e._stack.length&&e.push({page:n,path:o,title:i}),e._root&&n){var r=n();if(r instanceof P){var a=e._stack[e._stack.length-1];a&&a.disposeWidget(),e._stack[e._stack.length-1]=r;var u=e._root;e._removeAll(e._root),u.appendChild(r.render()),history.replaceState({title:i,path:o},i,o)}}}}]),e}();d(M,"_root",void 0),d(M,"_stack",[]);var R=function(){function e(){b(this,e)}return k(e,null,[{key:"addEvent",value:function(t,n){if(t&&n){var o=e._events[t];o||(o=[],e._events[t]=o),o.push(n)}}},{key:"removeAll",value:function(){_events={}}},{key:"removeEvent",value:function(t,n){if(t&&n){var o=e._events[t];if(o&&0!=o.length)for(var i=0;i<o.length;i++)if(o[i]==n){o.splice(i,1);break}}}},{key:"sendEvent",value:function(t,n){var o=e._events[t];o&&o instanceof Array&&o.forEach((function(e){e(n)}))}}]),e}();d(R,"_events",{});var V=function(){function e(t,n){b(this,e),this.oldWidget=t,this.newWidget=n}return k(e,[{key:"diff",value:function(){e.rebuild(this.newWidget);var t=this.oldWidget.child,n=this.newWidget.child;this.diffImpl(t,n,this.oldWidget),this.newWidget.initProps&&(this.oldWidget.initProps=this.newWidget.initProps)}},{key:"diffImpl",value:function(e,t,n){try{if(e.classType()!=t.classType())return void this._replaceWidget(e,t,n)}catch(e){console.error("compare type",e)}if(e.isContainer()){var o=t.children,i=e.children,r=i.length;if(o.length<i.length){for(var a=o.length;a<i.length;a++)e.elem.removeChild(i[a].elem);i.splice(o.length,i.length-o.length)}else if(o.length>i.length){for(var u=i.length;u<o.length;u++)e.elem.appendChild(o[u].render());i.push.apply(i,o.slice(i.length,o.length))}for(var s=o.length>r?r:o.length,l=0;l<s;l++)this.diffImpl(i[l],o[l],e);try{t.styleName!=e.styleName&&(e.styleName=t.styleName,e.elem.className=t.styleName)}catch(e){console.error("set class name error",e)}}else if(e.isComponent()){var c=e.child,d=t.child;this.diffImpl(c,d,e),this.newWidget.initProps&&(this.oldWidget.initProps=this.newWidget.initProps)}}},{key:"_replaceWidget",value:function(e,t,n){if(n.isContainer()){var o=n.children.indexOf(e);n.children[o]=t,n.elem&&n.elem.replaceChild(t.render(),e.elem)}else n.isComponent()&&(n.child=t,e.elem&&e.elem.parentNode&&e.elem.parentNode.replaceChild(t.render(),e.elem));e.disposeWidget()}}],[{key:"rebuild",value:function(t){t.isContainer()?t.children.forEach((function(t){t.isComponent()?e.rebuild(t.rebuild()):t.isContainer()&&e.rebuild(t)})):t.isComponent()?e.rebuild(t.rebuild()):console.log("other type")}},{key:"isBoyiaWidget",value:function(e){return e instanceof P}},{key:"isChildWidget",value:function(e){return"child"===e}},{key:"isChildren",value:function(e){return"children"===e}},{key:"cloneWidgetChildren",value:function(t){for(var n=[],o=0;o<t.length;o++)n.push(e.deepCloneWidget(t[o]));return n}},{key:"deepCloneWidget",value:function(t){if(!e.isBoyiaWidget(t))throw new Error("obj is not a boyia widget");var n=new t.constructor({styleName:t.styleName,onready:t.onready});for(var o in t)e.isChildWidget(o)?n[o]=e.deepCloneWidget(t[o]):e.isChildren(o)?n[o]=e.cloneWidgetChildren(t[o]):n[o]=t[o];return n}}]),e}();function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function A(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==W(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==W(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===W(i)?i:String(i)),o)}var i}var U,F=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.skinMap={},this.register({name:"black",style:{audioPlayer:"audio-player-black",audioContainerBlink:"audio-container-blink-black",audioButton:"audio-button-black",audioPlayButton:"audio-play-button-black",audioPlayPause:"audio-play-pause-black",audioPlayForwardFirst:"audio-forward-first-black",audioPlayForward:"audio-forward-black",audioBack:"audio-back-black",audioBackFirst:"audio-back-first-black",audioLayout:"audio-layout-black",audioButtonContainer:"audio-button-container-black",audioBottom:"audio-bottom-black",audioProgressCtrl:"audio-progress-ctrl-black",audioProgressContainer:"audio-progress-container-black",audioProgress:"audio-progress-black",audioImageContainer:"audio-image-container-black",audioImage:"audio-image-black",audioHeader:"audio-header-black",audioTitleContainer:"audio-title-container-black",audioTitleText:"audio-title-text-black",audioProgressText:"audio-progress-text-black",audioPlaylistContainer:"audio-playlist-container-black",audioPlaylistContainerHide:"audio-playlist-container-hide-black",audioPlaylistItem:"audio-playlist-item-black",audioPlaylistEvenItem:"audio-playlist-even-item-black",audioItemIndex:"audio-item-index-black",audioItemName:"audio-item-name-black",audioItemAuthor:"audio-item-author-black",audioItemFocus:"audio-item-name-focus-black",audioListButtonContainer:"audio-list-button-container-black",audioListButtonStyle:"audio-list-button-style-black",audioVolumeIconFirst:"audio-volume-icon-first-black",audioVolumeIcon:"audio-volume-icon-black",audioVolumeView:"audio-volume-view-black",audioVolumeProgress:"audio-volume-progress-black",audioVolumeBar:"audio-volume-bar-black",audioVolumeIconContainer:"audio-volume-icon-container-black",audioVolumeContainer:"audio-volume-container-black",audioLyricButtonContainer:"audio-lyric-button-container-black",audioLyricsContainer:"audio-lyrics-container-black",audioLyricItem:"audio-lyric-item-black",audioLyricRoot:"audio-lyrics-root-black",audioShadowTop:"audio-shadow-top-black",audioShadowBottom:"audio-shadow-bottom-black",audioLyricItemFocus:"audio-lyric-item-focus-black",audioNoLyricTip:"audio-no-lyric-tip-black",audioEffectContainer:"effect-container-black"}}),this.register({name:"default",style:{audioPlayer:"audio-player",audioContainerBlink:"audio-container-blink",audioButton:"audio-button",audioPlayButton:"audio-play-button",audioPlayPause:"audio-play-pause",audioPlayForwardFirst:"audio-forward-first",audioPlayForward:"audio-forward",audioBack:"audio-back",audioBackFirst:"audio-back-first",audioLayout:"audio-layout",audioButtonContainer:"audio-button-container",audioBottom:"audio-bottom",audioProgressCtrl:"audio-progress-ctrl",audioProgressContainer:"audio-progress-container",audioProgress:"audio-progress",audioImageContainer:"audio-image-container",audioImage:"audio-image",audioHeader:"audio-header",audioTitleContainer:"audio-title-container",audioTitleText:"audio-title-text",audioProgressText:"audio-progress-text",audioPlaylistContainer:"audio-playlist-container",audioPlaylistContainerHide:"audio-playlist-container-hide",audioPlaylistItem:"audio-playlist-item",audioPlaylistEvenItem:"audio-playlist-even-item",audioItemIndex:"audio-item-index",audioItemName:"audio-item-name",audioItemAuthor:"audio-item-author",audioItemFocus:"audio-item-name-focus",audioListButtonContainer:"audio-list-button-container",audioListButtonStyle:"audio-list-button-style",audioVolumeIconFirst:"audio-volume-icon-first",audioVolumeIcon:"audio-volume-icon",audioVolumeView:"audio-volume-view",audioVolumeProgress:"audio-volume-progress",audioVolumeBar:"audio-volume-bar",audioVolumeIconContainer:"audio-volume-icon-container",audioVolumeContainer:"audio-volume-container",audioLyricButtonContainer:"audio-lyric-button-container",audioLyricsContainer:"audio-lyrics-container",audioLyricItem:"audio-lyric-item",audioLyricRoot:"audio-lyrics-root",audioShadowTop:"audio-shadow-top",audioShadowBottom:"audio-shadow-bottom",audioLyricItemFocus:"audio-lyric-item-focus",audioNoLyricTip:"audio-no-lyric-tip",audioEffectContainer:"effect-container"}}),this.setSkin("black")}var t,n,o;return t=e,o=[{key:"instance",value:function(){return e.sInstance||(e.sInstance=new e),e.sInstance}}],(n=[{key:"getSkin",value:function(){return this.skin||(this.skin=this.skinMap[this.skinName]),this.skin}},{key:"register",value:function(e){console.log("SkinManager.js---register name="+e.name+" style="+e.style),this.skinMap[e.name]=e.style}},{key:"setSkin",value:function(e){this.skin=this.skinMap[e]}}])&&A(t.prototype,n),o&&A(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function H(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,G(o.key),o)}}function z(e,t,n){return(t=G(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e){var t=function(e,t){if("object"!==D(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==D(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===D(t)?t:String(t)}F.sInstance=null;var X=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"fetchPromise",value:function(t){var n=t.url,o=t.method,i=void 0===o?e.HttpMethod.get:o,r=t.headers,a=void 0===r?{}:r,u=t.data,s=t.responseType,l=void 0===s?"json":s;return new Promise((function(t,o){e.fetch({url:n,method:i,headers:a,data:u,responseType:l,success:function(e){t({status:"ok",data:e})},fail:function(e){o({status:"fail",reason:e})}})}))}},{key:"fetch",value:function(t){var n=t.url,o=t.method,i=void 0===o?e.HttpMethod.get:o,r=t.headers,a=void 0===r?{}:r,u=t.data,s=t.responseType,l=void 0===s?"json":s,c=t.success,d=t.fail,f=t.uploadProgress,h=t.onLoad;u=u||{};var y=e._methodMap[i](a,u);console.log("reqData = ",y),i===e.HttpMethod.get&&(n+=y);var p=new XMLHttpRequest;p.responseType=l,"blob"==l?h&&(p.onload=function(e){200==p.status&&h(e,p)}):p.onreadystatechange=function(){4===p.readyState&&(200===p.status?c&&"function"==typeof c&&c(p.response):d&&"function"==typeof d&&d(p.status))},f&&(p.upload.onprogress=function(e){e.lengthComputable&&f(e.loaded,e.total)}),p.open(i,n,!0),Object.keys(a).forEach((function(e){p.setRequestHeader(e,a[e])})),p.send(i===e.HttpMethod.post?y:null)}},{key:"_getPostJsonData",value:function(e){return JSON.stringify(e)}},{key:"_getPostFormData",value:function(e){if(0==Object.keys(e).length)return"";var t=[];for(var n in e)t.push("".concat(n,"=",e[n]));return t.join("&")}},{key:"_httpGetData",value:function(e,t){return 0==Object.keys(t).length?"":0===location.search.length?"".concat("?",t):"".concat("&",t)}},{key:"_httpPostData",value:function(t,n){var o=e._postMap[t["Content-Type"]];return o?o(n):n}},{key:"upload",value:function(t){var n=t.url,o=t.headers,i=void 0===o?{}:o,r=t.file,a=t.success,u=t.fail,s=t.uploadProgress,l=new FormData;l.append("file",r),e.fetch({url:n,headers:i,data:l,method:e.HttpMethod.post,success:a,fail:u,uploadProgress:s})}},{key:"download",value:function(t){var n=t.url,o=t.headers,i=void 0===o?{}:o;e.fetch({url:n,headers:i,responseType:"blob",method:e.HttpMethod.get,onLoad:function(e,t){var n=new Blob([t.response],{type:"application/octet-stream"}),o=t.getResponseHeader("Content-Disposition"),i=document.createElement("a"),r="unknow";if(o){var a=o.split("=");r=decodeURI(a[1])}console.log("BoyiaHttp download file name = "+r),i.href=window.URL.createObjectURL(n),i.download=r,i.click(),i.remove(),window.URL.revokeObjectURL(i.href)}})}}],null&&H(t.prototype,null),n&&H(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function Y(){return Y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Z(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Y.apply(this,arguments)}function J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}function K(e,t){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},K(e,t)}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Z(e);if(t){var i=Z(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}function ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function te(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,oe(o.key),o)}}function ne(e,t,n){return t&&te(e.prototype,t),n&&te(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function oe(e){var t=function(e,t){if("object"!==q(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==q(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===q(t)?t:String(t)}z(X,"HttpMethod",{get:"GET",post:"POST"}),z(X,"_postMap",{"application/x-www-form-urlencoded":X._getPostFormData,"application/json":X._getPostJsonData}),z(X,"_methodMap",(z(U={},X.HttpMethod.get,X._httpGetData),z(U,X.HttpMethod.post,X._httpPostData),U));var ie,re,ae,ue={kSpaceEffect:1,kNoEffect:2,kPillarEffect:3},se=250,le=function(){function e(t){ee(this,e),this._resetWidget(t)}return ne(e,[{key:"_resetWidget",value:function(e){this.widget=e,this.analyser=e.analyser,this.audio=e.audio,this.width=e.width,this.height=e.height}},{key:"render",value:function(){}}],[{key:"getRenderer",value:function(t,n){var o=e.effectRendererMap[t];return o?o._resetWidget(n):(o=e._createRenderer(t,n),e.effectRendererMap[t]=o),o}},{key:"_createRenderer",value:function(e,t){switch(e){case ue.kPillarEffect:return new he(t);case ue.kSpaceEffect:return new fe(t);case ue.kNoEffect:return new ye(t)}return null}}]),e}();ie=le,ae={},(re=oe(re="effectRendererMap"))in ie?Object.defineProperty(ie,re,{value:ae,enumerable:!0,configurable:!0,writable:!0}):ie[re]=ae;var ce=2*Math.PI,de=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.45;e.r<t&&(e.r=t),e.g<t&&(e.g=t),e.b<t&&(e.b=t)},fe=function(e){J(n,e);var t=Q(n);function n(e){var o;return ee(this,n),(o=t.call(this,e))._initResource(),o}return ne(n,[{key:"render",value:function(){this._renderEffect(),this.context&&this.context.putImageData(this.imageData,0,0)}},{key:"_resetWidget",value:function(e){Y(Z(n.prototype),"_resetWidget",this).call(this,e),this.context=e.canvasWidget.context,this.imageData=e.imageData,this.analyser.fftSize=8192}},{key:"_setPixel",value:function(e,t,n,o,i,r){var a=4*(e+t*this.imageData.width),u=this.imageData.data;u[a]=n,u[a+1]=o,u[a+2]=i,u[a+3]=r}},{key:"_initResource",value:function(){var e={};e.r=Math.random()*ce,e.g=Math.random()*ce,e.b=Math.random()*ce;var t={};t.r=Math.random()*ce,t.g=Math.random()*ce,t.b=Math.random()*ce,this.color=e,this.mixColor=t,this.time=0,this.colorInvertValue=0,this._addCircles()}},{key:"_renderEffect",value:function(){var e=!1;this.analyser&&(e=!0);var t=null;e&&(t=new Uint8Array(this.analyser.frequencyBinCount),this.analyser.getByteFrequencyData(t));var n,o=(n=this.color,{r:1*Math.sin(n.r+=.04)+1,g:1*Math.sin(n.g+=.028)+1,b:1*Math.sin(n.b+=.052)+1}),i=function(e){return{r:1*Math.sin(e.r+=.01)+1,g:1*Math.sin(e.g+=.007)+1,b:1*Math.sin(e.b+=.013)+1}}(this.mixColor);de(o,.45),de(i,.25);for(var r=!1,a=this.circleHolder,u=0,s=a.length;u<s;u++){var l=a[u];l.color.r=o.r-(l.z+se)/se,l.color.g=o.g-(l.z+se)/se,l.color.b=o.b-(l.z+se)/se,l.color.r<i.r&&(l.color.r=i.r),l.color.g<i.g&&(l.color.g=i.g),l.color.b<i.b&&(l.color.b=i.b);var c=void 0;u>0&&(c=a[u-1]),l.mp.x+=25e-5*(this.width/2-l.mp.x),l.mp.y+=25e-5*(this.height/2-l.mp.y),l.center.x=(this.width/2-l.mp.x)*((l.z-se)/500)+this.width/2,l.center.y=(this.height/2-l.mp.y)*((l.z-se)/500)+this.height/2;for(var d=0,f=l.segmentsOutside.length;d<f;d++){var h=l.segmentsOutside[d];if(!0===h.active){var y=se/(se+l.z),p=void 0;u>0&&(p=se/(se+c.z));var v=void 0,m=void 0;h.x2d=h.x*y+l.center.x,h.y2d=h.y*y+l.center.y,e&&(m=(v=t[h.audioBufferIndex])/20,h.radiusAudio=h.radius-m);var g=0;if(d>0&&(e&&!1===this.audio.paused?(g=Math.round(u/s*(55+v)))>255&&(g=255):g=Math.round(u/s*200)),u>0&&u<s-1){var b=h.subs[0],w=b.index*(ce/h.segments)+this.time;b.x2d=b.x*y+l.center.x,b.y2d=b.y*y+l.center.y,b.x=l.circleCenter.x+Math.cos(w)*h.radiusAudio,b.y=l.circleCenter.y+Math.sin(w)*h.radiusAudio;var k=h.subs[1],x=k.index*(ce/h.segments)+this.time;k.x2d=k.x*p+c.center.x,k.y2d=k.y*p+c.center.y,k.x=l.circleCenter.x+Math.cos(x)*h.radiusAudio,k.y=l.circleCenter.y+Math.sin(x)*h.radiusAudio;var P=h.subs[2],_=P.index*(ce/h.segments)+this.time;P.x2d=P.x*p+c.center.x,P.y2d=P.y*p+c.center.y,P.x=l.circleCenter.x+Math.cos(_)*h.radiusAudio,P.y=l.circleCenter.y+Math.sin(_)*h.radiusAudio;var S=h.subs[3],C=S.index*(ce/h.segments)+this.time;S.x2d=S.x*y+l.center.x,S.y2d=S.y*y+l.center.y,S.x=l.circleCenter.x+Math.cos(C)*h.radius,S.y=l.circleCenter.y+Math.sin(C)*h.radius;var L=h.subs[4],T=L.index*(ce/h.segments)+this.time;L.x2d=L.x*y+l.center.x,L.y2d=L.y*y+l.center.y,L.x=l.circleCenter.x+Math.cos(T)*h.radius,L.y=l.circleCenter.y+Math.sin(T)*h.radius;var O=h.subs[5],N=O.index*(ce/h.segments)+this.time;O.x2d=O.x*p+c.center.x,O.y2d=O.y*p+c.center.y,O.x=l.circleCenter.x+Math.cos(N)*h.radius,O.y=l.circleCenter.y+Math.sin(N)*h.radius;var j=h.subs[6],E=j.index*(ce/h.segments)+this.time;j.x2d=j.x*p+c.center.x,j.y2d=j.y*p+c.center.y,j.x=l.circleCenter.x+Math.cos(E)*h.radius,j.y=l.circleCenter.y+Math.sin(E)*h.radius;var I=void 0,B=void 0,M=void 0,R=void 0,V=h.subs[3],W=h.subs[4],A=h.subs[6],U=h.subs[5];m>0&&(I=h,B=h.subs[1],M=h.subs[2],R=h.subs[0]);var F=Math.round(l.color.r*g),D=Math.round(l.color.g*g),H=Math.round(l.color.b*g);m>0&&(this._drawLine(0|I.x2d,0|I.y2d,0|B.x2d,0|B.y2d,F,D,H,255),this._drawLine(0|B.x2d,0|B.y2d,0|M.x2d,0|M.y2d,F,D,H,255),this._drawLine(0|M.x2d,0|M.y2d,0|R.x2d,0|R.y2d,F,D,H,255),this._drawLine(0|R.x2d,0|R.y2d,0|I.x2d,0|I.y2d,F,D,H,255),this._drawLine(0|V.x2d,0|V.y2d,0|I.x2d,0|I.y2d,F,D,H,255),this._drawLine(0|W.x2d,0|W.y2d,0|R.x2d,0|R.y2d,F,D,H,255),this._drawLine(0|A.x2d,0|A.y2d,0|M.x2d,0|M.y2d,F,D,H,255),this._drawLine(0|U.x2d,0|U.y2d,0|B.x2d,0|B.y2d,F,D,H,255)),l.z<125&&(this._drawLine(0|V.x2d,0|V.y2d,0|W.x2d,0|W.y2d,F,D,H,255),this._drawLine(0|W.x2d,0|W.y2d,0|A.x2d,0|A.y2d,F,D,H,255),this._drawLine(0|A.x2d,0|A.y2d,0|U.x2d,0|U.y2d,F,D,H,255),this._drawLine(0|U.x2d,0|U.y2d,0|V.x2d,0|V.y2d,F,D,H,255))}var z=h.index*(ce/h.segments)+this.time;h.x=l.circleCenter.x+Math.cos(z)*h.radiusAudio,h.y=l.circleCenter.y+Math.sin(z)*h.radiusAudio}}l.z-=.75,l.z<-250&&(l.z+=500,r=!0)}r&&(a=a.sort((function(e,t){return t.z-e.z}))),this.time+=.005,this.colorInvertValue>0?this.colorInvertValue-=5:this.colorInvertValue=0,this.colorInvertValue>0&&this._dataInvert(this.colorInvertValue)}},{key:"_drawLine",value:function(e,t,n,o,i,r,a,u){for(var s=Math.abs(n-e),l=Math.abs(o-t),c=e<n?1:-1,d=t<o?1:-1,f=s-l,h=e,y=t;h>0&&h<this.width&&y>0&&y<this.height&&this._setPixel(h,y,i,r,a,u),h!==n||y!==o;){var p=2*f;p>-s&&(f-=l,h+=c),p<l&&(f+=s,y+=d)}}},{key:"_drawCircle",value:function(e,t,n){for(var o,i=[],r=0;r<=n;r++){var a=t;0===r&&(o=a),r===n&&(a=o);var u=e.x,s=e.y,l=this._getCirclePosition(u,s,a,r,n);i.push({x:l.x,y:l.y,index:r+0,radius:a,segments:n})}return i}},{key:"_getCirclePosition",value:function(e,t,n,o,i){var r=o*(ce/i)+this.time;return{x:e+Math.cos(r)*n,y:t+Math.sin(r)*n}}},{key:"_addCircles",value:function(){for(var e=[],t=8,n={x:0,y:0},o={x:0,y:0},i=1,r=0,a={x:Math.random()*this.width,y:Math.random()*this.height},u=-250;u<se;u+=5){var s=this._drawCircle(n,16,64),l={segmentsOutside:[],segmentsInside:[],segmentsInside2:[],segmentsCount:0};l.index=r,l.z=u,l.center=o,l.circleCenter={x:0,y:0},l.mp={x:a.x,y:a.y},l.radius=s[0].radius,l.color={r:0,g:0,b:0},i=r%2,r++,t=Math.floor(1024*Math.random())+8;for(var c=void 0,d=0,f=s.length;d<f;d++){var h=s[d];if(d%2===i){(c=this._addCircleSegment(h.x,h.y,u,t)).active=!0,c.index=h.index,c.radius=h.radius,c.radiusAudio=c.radius,c.segments=h.segments,c.coordinates=[];var y;y=d>0?s[d-1]:s[f-1];var p=this._addCircleSegment(y.x,y.y,u,t),v=this._addCircleSegment(h.x,h.y,u-5,t),m=this._addCircleSegment(y.x,y.y,u-5,t),g=this._addCircleSegment(h.x,h.y,u,t),b=this._addCircleSegment(y.x,y.y,u,t),w=this._addCircleSegment(h.x,h.y,u-5,t),k=this._addCircleSegment(y.x,y.y,u-5,t);p.index=y.index,v.index=h.index,m.index=y.index,g.index=h.index,b.index=y.index,w.index=h.index,k.index=y.index,c.subs=[],c.subs.push(p,v,m,g,b,w,k),t=d<f-1?Math.floor(1024*Math.random())+8:l.segmentsOutside[0].audioBufferIndex,l.segmentsOutside.push(c)}else l.segmentsOutside.push({active:!1})}e.push(l)}this.circleHolder=e}},{key:"_addCircleSegment",value:function(e,t,n,o){var i={};return i.x=e,i.y=t,i.x2d=0,i.y2d=0,i.audioBufferIndex=o,i}}]),n}(le),he=function(e){J(n,e);var t=Q(n);function n(e){return ee(this,n),t.call(this,e)}return ne(n,[{key:"_resetWidget",value:function(e){Y(Z(n.prototype),"_resetWidget",this).call(this,e),this.analyser.fftSize=128,this.context=e.canvasWidget.context}},{key:"render",value:function(){var e=!1;this.analyser&&(e=!0);var t=null;e&&(t=new Uint8Array(this.analyser.frequencyBinCount),this.analyser.getByteFrequencyData(t));var n=this.context;n.fillStyle="#000",n.fillRect(0,0,this.width,this.height);for(var o=this.analyser.frequencyBinCount,i=this.width/o,r=0,a=0;a<o;a++){var u=t[a]/255,s=a/o,l=this.height*u,c=255*u,d=255*s;n.fillStyle="rgb(".concat(c,",").concat(d,",").concat(50,")"),n.fillRect(r,this.height-l,i,l),r+=i+1}}}]),n}(le),ye=function(e){J(n,e);var t=Q(n);function n(e){return ee(this,n),t.call(this,e)}return ne(n,[{key:"_resetWidget",value:function(e){Y(Z(n.prototype),"_resetWidget",this).call(this,e),this.analyser.fftSize=128,this.context=e.canvasWidget.context}},{key:"render",value:function(){var e=this.context;e.fillStyle="#00000033",e.fillRect(0,0,this.width,this.height)}}]),n}(le);function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function ve(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,we(o.key),o)}}function me(e,t){return me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},me(e,t)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function be(e){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},be(e)}function we(e){var t=function(e,t){if("object"!==pe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==pe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===pe(t)?t:String(t)}var ke=ue,xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&me(e,t)}(a,e);var t,n,o,i,r=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=be(o);if(i){var n=be(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ge(e)}(this,e)});function a(e){e.type;var t,n=e.oncanplay,o=e.onplay,i=e.onended,u=e.onprogress,s=e.ontimeupdate,l=e.styleName,c=e.onready;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),function(e,t,n){(t=we(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(ge(t=r.call(this,{styleName:l,onready:c})),"_animateEffect",(function(){t.renderer&&(t._clearImageData(),t.renderer.render(),window.requestAnimationFrame(t._animateEffect))})),t.oncanplay=n,t.onplay=o,t.onended=i,t.onprogress=u,t.ontimeupdate=s,t.type=ue.kSpaceEffect,t.effectPause=!1,t}return t=a,(n=[{key:"_createAudio",value:function(){var e=new Audio;e.preload=!0,e.loop=!1,e.autoplay=!0,e.oncanplay=function(){console.log("on audio prepared duration="+e.duration)},e.onplay=this.onplay,e.onended=this.onended,e.onprogress=this.onprogress,e.ontimeupdate=this.ontimeupdate,e.onerror=e.onended,this.audio=e}},{key:"setType",value:function(e){this.type=e,this.analyser&&(this.renderer=le.getRenderer(this.type,this))}},{key:"seekTo",value:function(e){this.audio&&(this.audio.currentTime=e*this.elem.duration)}},{key:"currentTime",value:function(){return this.audio&&this.audio.currentTime}},{key:"duration",value:function(){return this.audio&&this.audio.duration}},{key:"hasUrl",value:function(){return this.audio&&this.audio.src}},{key:"setPlayUrl",value:function(e){this.pause(),this._createAudio(),this.audio.src=e,0!==e.indexOf("http")&&this.createAudioAnalyser()}},{key:"play",value:function(){var e=this;this.audio&&u.asyncTask({macroTask:function(){e._animateEffect(),e.audio.play()}})}},{key:"pause",value:function(){this.audio&&this.audio.pause()}},{key:"setVolume",value:function(e){this.audio&&(this.audio.volume=e)}},{key:"createAudioAnalyser",value:function(){var e=new s,t=e.createAnalyser();t.connect(e.destination),t.smoothingTimeConstant=.65,this.analyserBufferLength=t.frequencyBinCount;var n=e.createMediaElementSource(this.audio);n.connect(t),this.analyser=t,this.audioContext=e,this.audioSource=n,this.renderer=le.getRenderer(this.type,this)}},{key:"build",value:function(){var e=this;return new C({styleName:this.styleName,children:[new B({width:0,height:0,onready:function(t){e.canvasWidget=t}})],onready:function(t){e.canvasWidget&&u.asyncTask({macroTask:function(){e.width=t.offsetWidth(),e.height=t.offsetHeight(),e.canvasWidget.setCanvasSize(e.width,e.height),e.imageData=e.canvasWidget.imageData()}})}})}},{key:"_clearImageData",value:function(){for(var e=this.imageData.data,t=0;t<e.length;t+=4)e[t]=0,e[t+1]=0,e[t+2]=0,e[t+3]=255}}])&&ve(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(S);function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function _e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Se(o.key),o)}}function Se(e){var t=function(e,t){if("object"!==Pe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==Pe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Pe(t)?t:String(t)}function Ce(e,t){return Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ce(e,t)}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Le(e)}var Te={titleContainer:{maxWidth:"100%",display:"inline-block",verticalAlign:"top",overflow:"hidden",whiteSpace:"nowrap"},titleContent:function(e){return{animation:"audio-playlist-title-scroll linear ".concat(e,"s alternate infinite"),float:"left"}}},Oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ce(e,t)}(a,e);var t,n,o,i,r=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Le(o);if(i){var n=Le(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t,n=e.text,o=e.onready;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,{onready:o})).text=n,t.focus=!1,t}return t=a,(n=[{key:"setFocus",value:function(e){this.focus=e,this.setState({})}},{key:"_buildFocusWidget",value:function(){var e=u.measureText(this.text,"1rem normal sans-serif");return new C({style:Te.titleContainer,children:[new C({style:Te.titleContent(e/40),children:[new N(this.text)]})]})}},{key:"build",value:function(){var e=F.instance().getSkin(),t=this.focus?this._buildFocusWidget():new N(this.text);return new C({styleName:this.focus?e.audioItemFocus:e.audioItemName,children:[t]})}}])&&_e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(S);function Ne(e){return Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ne(e)}function je(){je=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var r=t&&t.prototype instanceof f?t:f,a=Object.create(r.prototype),u=new S(i||[]);return o(a,"_invoke",{value:k(e,n,u)}),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d={};function f(){}function h(){}function y(){}var p={};s(p,r,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(C([])));m&&m!==t&&n.call(m,r)&&(p=m);var g=y.prototype=f.prototype=Object.create(p);function b(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(o,r,a,u){var s=c(e[o],e,r);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==Ne(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,u)}),(function(e){i("throw",e,a,u)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,u)}))}u(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){i(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function k(e,t,n){var o="suspendedStart";return function(i,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===i)throw r;return{value:void 0,done:!0}}for(n.method=i,n.arg=r;;){var a=n.delegate;if(a){var u=x(a,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=c(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function x(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=c(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function C(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=y,o(g,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:h,configurable:!0}),h.displayName=s(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,i,r){void 0===r&&(r=Promise);var a=new w(l(t,n,o,i),r);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(g),s(g,u,"Generator"),s(g,r,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=C,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return a.type="throw",a.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var u=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(u&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(u){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var i=o.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function Ee(e,t,n,o,i,r,a){try{var u=e[r](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(o,i)}function Ie(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var r=e.apply(t,n);function a(e){Ee(r,o,i,a,u,"next",e)}function u(e){Ee(r,o,i,a,u,"throw",e)}a(void 0)}))}}function Be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Me(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ze(o.key),o)}}function Re(e,t,n){return t&&Me(e.prototype,t),n&&Me(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ve(){return Ve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=De(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Ve.apply(this,arguments)}function We(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ae(e,t)}function Ae(e,t){return Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ae(e,t)}function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=De(e);if(t){var i=De(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===Ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fe(e)}(this,n)}}function Fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},De(e)}function He(e,t,n){return(t=ze(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ze(e){var t=function(e,t){if("object"!==Ne(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==Ne(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ne(t)?t:String(t)}var Ge="User-Token",Xe="play_item_click",qe="play_list_loaded",Ye=function(e){We(o,e);var t,n=Ue(o);function o(e){var t,i=e.onready,r=void 0===i?void 0:i,a=e.playListUrl,u=void 0===a?"":a;return Be(this,o),He(Fe(t=n.call(this,{styleName:"",onready:r})),"_onPlayItemClick",(function(e){t.playIndex=e;var n=t.playList[e];t.image.setImageUrl(n.imgUrl),t.title.setTitle(n.name+"-"+n.author),t.playListView&&t.playListView.resetPlayItem(e),t.audio.setPlayUrl(n.playUrl),t.audio.play(),t.audioButton&&t.audioButton.setPlayStatus(),t.lyrics&&t.lyrics.showLyrics(t._currentLyricUrl(),!0)})),He(Fe(t),"_onPlay",(function(e){t.playList&&t.audio&&(t.audio.hasUrl()||t._onPlayItemClick(0),e?t.audio.play():t.audio.pause())})),t.playListUrl=u,t.type=ke.kPillarEffect,t}return Re(o,[{key:"initWidget",value:function(){this._loadPlaylist(),R.addEvent(Xe,this._onPlayItemClick)}},{key:"disposeWidget",value:function(){R.removeEvent(Xe,this._onPlayItemClick),Ve(De(o.prototype),"disposeWidget",this).call(this)}},{key:"_loadPlaylist",value:(t=Ie(je().mark((function e(){var t;return je().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.fetchPromise({url:this.playListUrl,headers:He({},Ge,"none"),method:X.HttpMethod.get});case 2:"ok"==(t=e.sent).status&&(console.log("playlist data = ",t),this.playIndex=0,this.playList=t.data,R.sendEvent(qe,this.playList));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_currentPlayUrl",value:function(){return this.playList&&0!=this.playList.length?this.playList[this.playIndex].playUrl:""}},{key:"_currentLyricUrl",value:function(){return this.playList&&0!=this.playList.length?this.playList[this.playIndex].lyricUrl:""}},{key:"_buildEffectAudio",value:function(){var e=this,t=F.instance().getSkin();return new I({onTap:function(){e.type=e.type>=ke.kPillarEffect?ke.kSpaceEffect:e.type+1,e.audio&&e.audio.setType(e.type)},child:new xe({type:this.type,styleName:t.audioEffectContainer,oncanplay:function(){},onplay:function(){},onended:function(){console.log("on play completed"),++e.playIndex>e.playList.length-1&&(e.playIndex=0),e._onPlayItemClick(e.playIndex)},onprogress:function(){},ontimeupdate:function(){e.audioProgress&&e.audio.currentTime()&&e.audio.duration()&&e.audioProgress.setProgress(e.audio.currentTime(),e.audio.duration()),e.lyrics&&e.audio&&e.lyrics.setTime(e._currentLyricUrl(),e.audio.currentTime())},onready:function(t){e.audio=t}})})}},{key:"_buildAudio",value:function(){var e=this;return new j({oncanplay:function(){},onplay:function(){},onended:function(){console.log("on play completed"),++e.playIndex>e.playList.length-1&&(e.playIndex=0),e._onPlayItemClick(e.playIndex)},onprogress:function(){},ontimeupdate:function(){e.audioProgress&&e.audio.currentTime()&&e.audio.duration()&&e.audioProgress.setProgress(e.audio.currentTime(),e.audio.duration()),e.lyrics&&e.audio&&e.lyrics.setTime(e._currentLyricUrl(),e.audio.currentTime())},onready:function(t){e.audio=t}})}},{key:"_buildAudioInfo",value:function(e){var t=this;return new C({styleName:e.audioHeader,children:[new Je({onready:function(e){t.image=e}}),new $e({widget:this._buildEffectAudio(),onready:function(e){t.title=e}}),new Ke({onready:function(e){t.audioListButton=e},onListButtonClick:function(){t.playListView&&t.playListView.show(!t.playListView.isVisible())}}),new rt({onLyricsButtonClick:function(){t.lyrics&&t.lyrics.showLyrics(t._currentLyricUrl())}})]})}},{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new C({styleName:"",children:[new C({styleName:t.audioContainerBlink}),new C({styleName:t.audioPlayer,children:[this._buildAudioInfo(t),this._buildTools(t)]}),new it({playList:this.playList,onready:function(t){e.playListView=t}}),new at({styleName:t.audioLyricsContainer,onready:function(t){e.lyrics=t}})]})}},{key:"_buildTools",value:function(e){var t=this;return new C({styleName:e.audioBottom,children:[new Qe({onBack:function(){--t.playIndex<0&&(t.playIndex=0),t._onPlayItemClick(t.playIndex)}}),new Ze({onClick:this._onPlay,onready:function(e){t.audioButton=e}}),new et({onForward:function(){++t.playIndex>t.playList.length-1&&(t.playIndex=0),t._onPlayItemClick(t.playIndex)}}),new tt({onready:function(e){t.audioProgress=e},onAudioProgressUpdate:function(e){t.title&&t.title.updateProgressText(e)},onSeek:function(e){t.audio&&t.audio.duration()&&t.audio.seekTo(e)}}),new nt({onSetVolume:function(e){t.audio&&(console.log("audio.js---onSetVolume()---volume: "+e),t.audio.setVolume(e))}})]})}}]),o}(S),Je=function(e){We(n,e);var t=Ue(n);function n(e){var o=e.onready,i=void 0===o?void 0:o;return Be(this,n),t.call(this,{styleName:"",onready:i})}return Re(n,[{key:"setImageUrl",value:function(e){this.image&&this.image.setImageUrl(e)}},{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new C({styleName:t.audioImageContainer,children:[new L({styleName:t.audioImage,onready:function(t){e.image=t}})]})}}]),n}(_),$e=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.widget,r=e.onready,a=void 0===r?void 0:r;return Be(this,n),(o=t.call(this,{styleName:"",onready:a})).title="",o.progressText="00:00-00:00",o.widget=i,o}return Re(n,[{key:"setTitle",value:function(e){this.title&&this.title.setText(e)}},{key:"updateProgressText",value:function(e){this.audioProgressText&&this.audioProgressText.setText(e)}},{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new C({styleName:t.audioTitleContainer,children:[this.widget,new C({styleName:t.audioTitleText,children:[new N(this.title,(function(t){e.title=t}))]}),new C({styleName:t.audioProgressText,children:[new N(this.progressText,(function(t){e.audioProgressText=t}))]})]})}}]),n}(_),Ke=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.onready,r=void 0===i?void 0:i,a=e.onListButtonClick,u=void 0===a?void 0:a;return Be(this,n),(o=t.call(this,{styleName:"",onready:r})).onListButtonClick=u,o}return Re(n,[{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new I({onTap:function(){e.onListButtonClick&&e.onListButtonClick()},child:new C({styleName:t.audioListButtonContainer,children:[new C({styleName:t.audioListButtonStyle}),new C({styleName:t.audioListButtonStyle}),new C({styleName:t.audioListButtonStyle})]})})}}]),n}(_),Qe=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.onBack,r=void 0===i?void 0:i;return Be(this,n),(o=t.call(this,{styleName:""})).onBack=r,o}return Re(n,[{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new I({onTap:function(){e.onBack&&e.onBack()},child:new C({styleName:t.audioButtonContainer,children:[new C({styleName:"".concat(t.audioButton," ").concat(t.audioBackFirst)}),new C({styleName:"".concat(t.audioButton," ").concat(t.audioBack)})]})})}}]),n}(_),Ze=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.onClick,r=void 0===i?void 0:i,a=e.onready;return Be(this,n),(o=t.call(this,{styleName:"",onready:a})).onClick=r,o.status=!1,o}return Re(n,[{key:"setPlayStatus",value:function(){var e=F.instance().getSkin();this.status=!0,this.buttonStatus.setStyle("".concat(e.audioButton," ").concat(e.audioPlayPause))}},{key:"changeStyle",value:function(){var e=F.instance().getSkin();this.status=!this.status,this.buttonStatus.setStyle(this.status?"".concat(e.audioButton," ").concat(e.audioPlayPause):"".concat(e.audioButton," ").concat(e.audioPlayButton))}},{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new I({onTap:function(){e.changeStyle(),e.onClick(e.status)},child:new C({styleName:"".concat(t.audioButtonContainer," ").concat(t.audioLayout),children:[new C({styleName:"".concat(t.audioButton," ").concat(t.audioPlayButton),onready:function(t){e.buttonStatus=t}})]})})}}]),n}(_),et=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.onForward,r=void 0===i?void 0:i;return Be(this,n),(o=t.call(this,{styleName:""})).onForward=r,o}return Re(n,[{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new I({onTap:function(){e.onForward&&e.onForward()},child:new C({styleName:"".concat(t.audioButtonContainer," ").concat(t.audioLayout),children:[new C({styleName:"".concat(t.audioButton," ").concat(t.audioPlayForwardFirst)}),new C({styleName:"".concat(t.audioButton," ").concat(t.audioPlayForward)})]})})}}]),n}(_),tt=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.onready,r=void 0===i?void 0:i,a=e.onAudioProgressUpdate,u=void 0===a?void 0:a,s=e.onSeek,l=void 0===s?void 0:s;return Be(this,n),He(Fe(o=t.call(this,{styleName:"",onready:r})),"_onClick",(function(e){var t=o.audioProgressContainer.getBoundingClientRect();console.log("position"+JSON.stringify(t)+" event="+e.clientX),o.setProgress(e.clientX-t.left,t.right-t.left),o.onSeek&&o.onSeek((e.clientX-t.left)/(t.right-t.left))})),o.onAudioProgressUpdate=u,o.onSeek=l,o}return Re(n,[{key:"setProgress",value:function(e,t){this.progress&&(this.progress.setWidth((e/t*100).toFixed(2)+"%"),this.onAudioProgressUpdate&&this.onAudioProgressUpdate(u.timeFormat(e)+"-"+u.timeFormat(t)))}},{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new C({styleName:t.audioProgressCtrl,children:[new I({onTap:this._onClick,child:new C({styleName:t.audioProgressContainer,children:[new C({styleName:t.audioProgress,onready:function(t){e.progress=t}})],onready:function(t){e.audioProgressContainer=t}})})]})}}]),n}(_),nt=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.onSetVolume,r=void 0===i?void 0:i;return Be(this,n),He(Fe(o=t.call(this,{styleName:""})),"_onClick",(function(e){if(o.audioVolumeContainer&&o.audioVolumeProgress&&o.audioVolumeBar){var t=o.audioVolumeContainer.getBoundingClientRect();if(t){var n=t.right-t.left,i=e.clientX-t.left;i<0&&(i=0),e.clientX-t.left>n&&(i=n),console.log("position"+JSON.stringify(t)+" event="+e.clientX),o.position=i,o._setVolume()}}})),o.mute=!1,o.onSetVolume=r,o.position=0,o}return Re(n,[{key:"_setVolume",value:function(){var e=this.audioVolumeContainer.getBoundingClientRect();if(e){var t=e.right-e.left,n=this.position,o=n/t;this.audioVolumeProgress.setWidth((100*o).toFixed(2)+"%"),console.log("audioVolumeBar width="+this.audioVolumeBar.offsetWidth()),this.audioVolumeBar.setLeft((n-this.audioVolumeBar.offsetWidth()<0?0:n-this.audioVolumeBar.offsetWidth())+"px"),n>0&&(this.mute=!1),this._setMuteStyle(),this.onSetVolume(o)}}},{key:"_setMute",value:function(){this.audioVolumeProgress.setWidth("0px"),this.audioVolumeBar.setLeft("0px"),this._setMuteStyle(),this.onSetVolume(0)}},{key:"_setMuteStyle",value:function(){this.muteRef&&this.muteRef.setStyle(this.mute?"audio-volume-mute":"audio-widget-hide")}},{key:"_buildVolumeIcon",value:function(e){var t=this;return new I({onTap:function(){t.mute=!t.mute,t.mute?t._setMute():t._setVolume()},child:new C({styleName:"audio-volume-left-container",children:[new C({styleName:e.audioVolumeIconContainer,children:[new C({styleName:"".concat(e.audioButton," ").concat(e.audioVolumeIconFirst)}),new C({styleName:"".concat(e.audioButton," ").concat(e.audioVolumeIcon)})]}),new C({styleName:this.mute?"audio-volume-mute":"audio-widget-hide",onready:function(e){t.muteRef=e}})]})})}},{key:"_buildVolumeProgress",value:function(e){var t=this;return new I({onTap:this._onClick,child:new C({styleName:e.audioVolumeView,children:[new C({styleName:e.audioVolumeProgress,onready:function(e){t.audioVolumeProgress=e}}),new C({styleName:e.audioVolumeBar,onready:function(e){t.audioVolumeBar=e}})],onready:function(e){t.audioVolumeContainer=e}})})}},{key:"build",value:function(){var e=F.instance().getSkin();return new C({styleName:e.audioVolumeContainer,children:[this._buildVolumeIcon(e),this._buildVolumeProgress(e)]})}}]),n}(_),ot=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.item,r=e.index,a=e.onready,u=void 0===a?void 0:a;return Be(this,n),(o=t.call(this,{styleName:"",onready:u})).item=i,o.index=r,o}return Re(n,[{key:"setItemStatus",value:function(){this.audioPlayItemName&&this.audioPlayItemName.setFocus(!0)}},{key:"resetItemStatus",value:function(){this.audioPlayItemName&&this.audioPlayItemName.setFocus(!1)}},{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new I({onTap:function(){R.sendEvent(Xe,e.index)},child:new C({styleName:this.index%2==0?t.audioPlaylistItem:t.audioPlaylistEvenItem,children:[new C({styleName:t.audioItemIndex,children:[new N("".concat(this.item.playId,". "))]}),new Oe({text:this.item.name,onready:function(t){e.audioPlayItemName=t}}),new C({styleName:t.audioItemAuthor,children:[new N(this.item.author)]}),new C({styleName:"audio-playlist-item-hover"})]})})}}]),n}(_),it=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.playList,r=void 0===i?void 0:i,a=e.onready,u=void 0===a?void 0:a;return Be(this,n),He(Fe(o=t.call(this,{styleName:"",onready:u})),"_onPlayListLoaded",(function(e){o.setStateAsync({playList:e},(function(){R.sendEvent(Xe,o.focusIndex)}))})),o.state={playList:r},o}return Re(n,[{key:"initWidget",value:function(){R.addEvent(qe,this._onPlayListLoaded),this.visible=!0,this.playListItems=[],this.focusIndex=0}},{key:"disposeWidget",value:function(){R.removeEvent(qe,this._onPlayListLoaded)}},{key:"resetPlayItem",value:function(e){this.playListItems[this.focusIndex].resetItemStatus(),this.focusIndex=e,this.playListItems[this.focusIndex].setItemStatus()}},{key:"show",value:function(e){if(this.visible=e,this.audioPlaylistContainer){var t=F.instance().getSkin();this.audioPlaylistContainer.setStyle(e?t.audioPlaylistContainer:t.audioPlaylistContainerHide)}}},{key:"isVisible",value:function(){return this.visible}},{key:"build",value:function(){var e=this,t=[];this.state.playList&&this.state.playList.forEach((function(n,o){t.push(new ot({item:n,index:o,onready:function(t){e.playListItems.push(t)}}))}));var n=F.instance().getSkin();return new C({styleName:n.audioPlaylistContainer,children:t,onready:function(t){e.audioPlaylistContainer=t}})}}]),n}(S),rt=function(e){We(n,e);var t=Ue(n);function n(e){var o,i=e.onLyricsButtonClick,r=void 0===i?void 0:i;return Be(this,n),(o=t.call(this,{styleName:""})).onLyricsButtonClick=r,o}return Re(n,[{key:"build",value:function(){var e=this,t=F.instance().getSkin();return new I({onTap:function(){e.onLyricsButtonClick&&e.onLyricsButtonClick()},child:new C({styleName:t.audioLyricButtonContainer,children:[new N("")]})})}}]),n}(_),at=function(e){We(o,e);var t,n=Ue(o);function o(e){var t=e.styleName,i=void 0===t?"":t,r=e.onready,a=void 0===r?void 0:r;return Be(this,o),n.call(this,{styleName:i,onready:a})}return Re(o,[{key:"initWidget",value:function(){this.show=!1,this.lyricsMap={},this.focusIndex=0}},{key:"getInitProps",value:function(){return this.initProps||(this.initProps={}),this.initProps}},{key:"_parseLyric",value:function(e){var t,n=[],o=null!==(t=e.split("\n"))&&void 0!==t?t:[];if(0==o.length)return n;for(var i=/\[\d{2}:\d{2}.\d{2}\]/g;o.length>0&&!i.test(o[0]);)o=o.slice(1);return 0===o[o.length-1].length&&o.pop(),o.forEach((function(e){var t=e.match(i),o=e.replace(i,"");t.forEach((function(e){var t=e.slice(1,-1).split(":");n.push({time:60*parseInt(t[0],10)+parseFloat(t[1]),lyric:o})}))})),n.sort((function(e,t){return e.time-t.time})),n}},{key:"showLyrics",value:(t=Ie(je().mark((function e(t){var n,o,i=arguments;return je().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.length>1&&void 0!==i[1]&&i[1])){e.next=6;break}if(this.show){e.next=4;break}return e.abrupt("return");case 4:e.next=7;break;case 6:this.show=!this.show;case 7:if(this.show&&t){e.next=11;break}return this.lyrics=null,this.setStateAsync({}),e.abrupt("return");case 11:if(n=this.lyricsMap[t]){e.next=17;break}return e.next=15,X.fetchPromise({url:t,headers:He({},Ge,"none"),method:X.HttpMethod.get,responseType:"text"});case 15:"ok"==(o=e.sent).status&&(console.log("lyric data = ",o),n=this._parseLyric(o.data),this.lyricsMap[t]=n);case 17:this.lyrics=n,this.setStateAsync({});case 19:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"setTime",value:function(e,t){var n=this.lyricsMap[e];if(n)for(var o=n.length-1;o>=0;o--)if(t>n[o].time){this._setFocus(o);break}}},{key:"_setFocus",value:function(e){this.focusIndex!=e&&(this.focusIndex=e,this.show&&(this.getInitProps().container&&this.getInitProps().container.scrollTo(u.remToPx(1.8)*e),this.setStateAsync({})))}},{key:"_buildItemListContainer",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=n.length>0;return new C({onready:function(e){t.getInitProps().container=e},styleName:o?e.audioLyricsContainer:e.audioNoLyricTip,children:o?n:[new N("No Lyric")]})}},{key:"build",value:function(){var e=this;if(!this.show)return new C({});var t=F.instance().getSkin(),n=[];return this.lyrics&&this.lyrics.length>0&&this.lyrics.forEach((function(o,i){n.push(e._buildLyricItem(o.lyric,i,t))})),new C({styleName:t.audioLyricRoot,children:[this._buildItemListContainer(t,n),new C({styleName:t.audioShadowTop}),new C({styleName:t.audioShadowBottom})]})}},{key:"_buildLyricItem",value:function(e,t,n){return new C({styleName:t==this.focusIndex?n.audioLyricItemFocus:n.audioLyricItem,children:[new N(e)]})}}]),o}(S);function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function st(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,lt(o.key),o)}}function lt(e){var t=function(e,t){if("object"!==ut(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==ut(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ut(t)?t:String(t)}function ct(e,t){return ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ct(e,t)}function dt(e){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dt(e)}var ft=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ct(e,t)}(a,e);var t,n,o,i,r=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=dt(o);if(i){var n=dt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ut(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t,n=e.theme,o=e.id,i=e.onSwitchChecked;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,{styleName:"",id:o})).theme=n,t.onSwitchChecked=i,t}return t=a,(n=[{key:"build",value:function(){var e=this;return new C({styleName:"bui-switch",children:[new O({id:this.id,onClick:function(){e.checkbox&&e.onSwitchChecked&&e.onSwitchChecked(e.checkbox.checked())},onready:function(t){e.checkbox=t}}),new E({forId:this.id,styleName:this.theme})]})}}])&&st(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(_);function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function yt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,bt(o.key),o)}}function pt(e,t){return pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pt(e,t)}function vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mt(e){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mt(e)}function gt(e,t,n){return(t=bt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e){var t=function(e,t){if("object"!==ht(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==ht(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ht(t)?t:String(t)}var wt={login:{path:"/boyiaweb/index/login",title:"login",page:function(){return new C({styleName:""})}},home:{path:"/boyiaweb/index/home",title:"home",page:function(){return new kt({styleName:""})}}},kt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pt(e,t)}(a,e);var t,n,o,i,r=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=mt(o);if(i){var n=mt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return vt(e)}(this,e)});function a(e){var t,n=e.styleName,o=void 0===n?"":n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),gt(vt(t=r.call(this,{styleName:o})),"onMouseDown",(function(e){t.moving=!0,t.playerContainer&&(t.playerLeft=e.clientX,t.playerTop=e.clientY,t.playerOffsetLeft=t.playerContainer.offsetLeft(),t.playerOffsetTop=t.playerContainer.offsetTop(),console.log("playerOffsetLeft="+t.playerContainer.offsetLeft()+" playerOffsetLeft"+t.playerContainer.offsetTop()),t.playerContainer.setCursor("move"))})),gt(vt(t),"_onMouseMove",(function(e){if(t.playerContainer&&t.moving){console.log("playerLeft="+t.playerLeft+" playerTop"+t.playerTop);var n=e.clientX-(t.playerLeft-t.playerOffsetLeft),o=e.clientY-(t.playerTop-t.playerOffsetTop);console.log("index.js---onMouseMove---left: "+n+" top: "+o),t.playerContainer.setLeft(n+"px"),t.playerContainer.setTop(o+"px")}})),gt(vt(t),"onMouseUp",(function(e){console.log("index.js---onMouseUp"),t.moving=!1,t.playerContainer&&t.playerContainer.setCursor("default")})),gt(vt(t),"_onTouchStart",(function(e){t.moving=!0,t.playerContainer&&(t.playerLeft=e.touches[0].clientX,t.playerTop=e.touches[0].clientY,t.playerOffsetLeft=t.playerContainer.offsetLeft(),t.playerOffsetTop=t.playerContainer.offsetTop(),console.log("playerOffsetLeft="+t.playerContainer.offsetLeft()+" playerOffsetLeft"+t.playerContainer.offsetTop()),t.playerContainer.setCursor("move"))})),gt(vt(t),"_onTouchMove",(function(e){if(t.playerContainer&&t.moving){console.log("playerLeft="+t.playerLeft+" playerTop"+t.playerTop);var n=e.touches[0].clientX-(t.playerLeft-t.playerOffsetLeft),o=e.touches[0].clientY-(t.playerTop-t.playerOffsetTop);console.log("index.js---onMouseMove---left: "+n+" top: "+o),t.playerContainer.setLeft(n+"px"),t.playerContainer.setTop(o+"px")}})),window.onmousemove=t._onMouseMove,window.ontouchmove=t._onTouchMove,t.playerLeft=-1,t.playerTop=-1,t.playerOffsetLeft=-1,t.playerOffsetTop=-1,t}return t=a,(n=[{key:"_buildSetting",value:function(){var e=this;return new C({styleName:"setting-panel",children:[new C({styleName:"setting-item",children:[new C({styleName:"setting-title",children:[new N("Skin Change")]}),new ft({id:"oneOpen",theme:"bui-theme-blue",onSwitchChecked:function(t){t?F.instance().setSkin("default"):F.instance().setSkin("black"),e.audio&&e.audio.setState({})}})]})]})}},{key:"build",value:function(){var e=this;return new C({styleName:"page-main",children:[this._buildSetting(),new I({onTouchStart:this._onTouchStart,onTouchEnd:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,child:new C({styleName:"index-audio-player",children:[new Ye({onready:function(t){e.audio=t},playListUrl:kPlaylistUrl})],onready:function(t){e.playerContainer=t}})})]})}}])&&yt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(S);$(document).ready((function(){M.init(),M.push(wt.home)}))})();