/*! For license information please see index.min.js.LICENSE.txt */
(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e,n){return(e=u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(){n=function(){return e};var e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function d(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,a=Object.create(o.prototype),u=new L(r||[]);return i(a,"_invoke",{value:S(t,n,u)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var h={};function y(){}function p(){}function v(){}var m={};s(m,u,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(T([])));b&&b!==r&&o.call(b,u)&&(m=b);var w=v.prototype=y.prototype=Object.create(m);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function x(e,n){function r(i,a,u,l){var c=f(e[i],e,a);if("throw"!==c.type){var s=c.arg,d=s.value;return d&&"object"==t(d)&&o.call(d,"__await")?n.resolve(d.__await).then((function(t){r("next",t,u,l)}),(function(t){r("throw",t,u,l)})):n.resolve(d).then((function(t){s.value=t,u(s)}),(function(t){return r("throw",t,u,l)}))}l(c.arg)}var a;i(this,"_invoke",{value:function(t,e){function o(){return new n((function(n,o){r(t,e,n,o)}))}return a=a?a.then(o,o):o()}})}function S(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var u=_(a,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=f(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function _(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=f(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:O}}function O(){return{value:void 0,done:!0}}return p.prototype=v,i(w,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:p,configurable:!0}),p.displayName=s(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},k(x.prototype),s(x.prototype,l,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new x(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(w),s(w,c,"Generator"),s(w,u,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=o.call(i,"catchLoc"),l=o.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;C(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function r(t,e,n,r,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void n(t)}u.done?e(l):Promise.resolve(l).then(r,o)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===t(n)?n:String(n)}var l="canvas",c=function(){function t(){o(this,t)}var e,i;return a(t,null,[{key:"show",value:(e=n().mark((function t(e){var r,o,i,a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.msg,o=void 0===r?"":r,(i=document.createElement("div")).innerHTML=o,i.className="boyia-toast",document.body.appendChild(i),a=.5,t.next=8,s.asyncTaskPromise({macroTask:function(){i.style.transition="-webkit-transform "+a+"s ease-in, opacity "+a+"s ease-in",i.style.opacity="0"},duration:1e3});case 8:return t.next=10,s.asyncTaskPromise({macroTask:function(){document.body.removeChild(i)},duration:1e3*a});case 10:case"end":return t.stop()}}),t)})),i=function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function u(t){r(a,o,i,u,l,"next",t)}function l(t){r(a,o,i,u,l,"throw",t)}u(void 0)}))},function(t){return i.apply(this,arguments)})}]),t}(),s=function(){function t(){o(this,t)}return a(t,null,[{key:"getUrlParams",value:function(){}},{key:"remToPx",value:function(t){return 12*t}},{key:"objToStyle",value:function(t,e){if(e&&e instanceof Object){var n=t.style;for(var r in e)n[r]=e[r]}}},{key:"asyncTask",value:function(t){var e=t.macroTask,n=t.duration,r=void 0===n?0:n,o=t.completed,i=t.fail,a=setTimeout((function(){try{var t=e();window.clearTimeout(a),o&&o(t)}catch(t){console.error("asyncTask error: ",t),i&&i(t)}}),r)}},{key:"asyncTaskPromise",value:function(e){var n=e.macroTask,r=e.duration,o=void 0===r?0:r;return new Promise((function(e,r){t.asyncTask({macroTask:n,duration:o,completed:function(t){e(t)},fail:function(t){r(t)}})}))}},{key:"measureText",value:function(t,e){var n=document.createElement(l).getContext("2d");return n.font=e,n.measureText(t).width}},{key:"extend",value:function(t){for(var e=t.objs,n=void 0===e?[]:e,r={},o=0;o<n.length;o++){var i=n[o];if(i instanceof Object)for(var a in i)r[a]=i[a]}return r}}]),t}();e(s,"timeFormat",(function(t){var e=parseInt(t/60),n=parseInt(t%60);return(e<10?"0"+e:e)+":"+(n<10?"0"+n:n)})),Array.prototype.indexOf=function(t){for(var e=0;e<this.length;e++)if(this[e]==t)return e;return-1},Array.prototype.remove=function(t){var e=this.indexOf(t);e>-1&&this.splice(e,1)},Array.prototype.clear=function(){this.length>0&&this.splice(0,this.length)},String.format=function(t){var e=Array.prototype.slice.call(arguments,1);return t.replace(/{(\d+)}/g,(function(t,n){return void 0!==e[n]?e[n]:t}))};var d=function(){function t(){o(this,t)}return a(t,null,[{key:"setData",value:function(e,n){t._storage[e]=n,localStorage.setItem(e,n)}},{key:"getObject",value:function(t){var e=localStorage.getItem(t);return e?JSON.parse(e):null}},{key:"setObject",value:function(t,e){if(e){var n=localStorage.setItem(t,JSON.stringify(e));console.log("result = ".concat(n))}}},{key:"getData",value:function(e){var n=t._storage[e];return n||((n=localStorage.getItem(e))&&(t._storage[e]=n),n)}},{key:"removeData",value:function(e){t._storage[e]&&delete t._storage[e],localStorage.removeItem(e)}}]),t}();e(d,"_storage",{});var f=window.AudioContext||window.webkitAudioContext,h=a((function t(){o(this,t)}));function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function p(t,e,n){return(e=C(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},v.apply(this,arguments)}function m(){m=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,o){var i=e&&e.prototype instanceof f?e:f,a=Object.create(i.prototype),u=new L(o||[]);return r(a,"_invoke",{value:S(t,n,u)}),a}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d={};function f(){}function h(){}function p(){}var v={};l(v,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(T([])));b&&b!==e&&n.call(b,i)&&(v=b);var w=p.prototype=f.prototype=Object.create(v);function k(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function o(r,i,a,u){var l=s(t[r],t,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==y(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(d).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,u)}))}u(l.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function S(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var u=_(a,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function _(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=p,r(w,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:h,configurable:!0}),h.displayName=l(p,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},k(x.prototype),l(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new x(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(w),l(w,u,"Generator"),l(w,i,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;C(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function g(t,e,n,r,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void n(t)}u.done?e(l):Promise.resolve(l).then(r,o)}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}function w(t,e){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=x(t);if(e){var o=x(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,C(r.key),r)}}function P(t,e,n){return e&&_(t.prototype,e),n&&_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function C(t){var e=function(t,e){if("object"!==y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===y(e)?e:String(e)}e(h,"USE_STATE",!0),e(h,"USE_STATE_UI_UPDATE",!1);var L=function(){function t(e){var n=e.styleName,r=void 0===n?"":n,o=e.id,i=void 0===o?"":o,a=e.onready,u=void 0===a?void 0:a;S(this,t),this.styleName=r,this.id=i,this.onready=u}return P(t,[{key:"initWidget",value:function(){}},{key:"disposeWidget",value:function(){if(this.isContainer()&&this.children)for(var t=0;t<this.children.length;t++)this.children[t].disposeWidget();else this.isComponent()&&this.child&&this.child.disposeWidget()}},{key:"build",value:function(){return this}},{key:"isContainer",value:function(){return!1}},{key:"render",value:function(){return this.elem=this._render(),this.onready&&this.elem&&this.onready(this),this.elem}},{key:"_render",value:function(){return this.isComponent()?this.build().render():null}},{key:"isComponent",value:function(){return!1}},{key:"classType",value:function(){return this.constructor}}]),t}(),T=function(t){b(n,t);var e=k(n);function n(t){var r=t.styleName,o=t.id,i=void 0===o?"":o,a=t.onready,u=void 0===a?void 0:a;return S(this,n),e.call(this,{styleName:r,id:i,onready:u})}return P(n,[{key:"isComponent",value:function(){return!0}},{key:"rebuild",value:function(){return this.child=this.build(),this.child}},{key:"_render",value:function(){return this.child||(this.initWidget(),this.child=this.build()),this.child.render()}}]),n}(L),O=function(t){b(o,t);var e,n,r=k(o);function o(t){var e,n=t.styleName,i=t.onready,a=void 0===i?void 0:i;return S(this,o),(e=r.call(this,{styleName:n,onready:a})).state={},e}return P(o,[{key:"rebuild",value:function(){return this.child=this.build(),this.child}},{key:"isComponent",value:function(){return!0}},{key:"setStateAsync",value:(e=m().mark((function t(e,n){var r=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.asyncTaskPromise({macroTask:function(){r.setState(e)}});case 2:n&&n();case 3:case"end":return t.stop()}}),t)})),n=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(t){g(i,r,o,a,u,"next",t)}function u(t){g(i,r,o,a,u,"throw",t)}a(void 0)}))},function(t,e){return n.apply(this,arguments)})},{key:"setState",value:function(t){if(h.USE_STATE){this.state=t;var e=G.cloneWidget(this);new G(this,e).diff()}else if(h.USE_STATE_UI_UPDATE){var n;this.state=t,console.log("BoyiaStateWidget setState parent = "+(this.node&&this.node.parentNode?this.node.parentNode:null)),this.node&&this.node.parentNode&&(n=this.node.parentNode).removeChild(this.node),G.rebuild(this),this.render(),this.node&&n&&n.appendChild(this.node)}}},{key:"_render",value:function(){return this.child||(this.initWidget(),this.child=this.build()),this.child&&(this.node=this.child.render()),this.node}}]),o}(L),E=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.id,i=void 0===o?"":o,a=t.styleName,u=void 0===a?"":a,l=t.style,c=void 0===l?void 0:l,s=t.children,d=void 0===s?[]:s,f=t.onready,h=void 0===f?void 0:f;if(S(this,n),r=e.call(this,{styleName:u,id:i,onready:h}),!(d instanceof Array))throw new Error("children is not a chilren");return r.children=d,r.style=c,r}return P(n,[{key:"width",value:function(){return this.elem?this.elem.clientWidth:0}},{key:"height",value:function(){return this.elem?this.elem.clientHeight:0}},{key:"setWidth",value:function(t){this.elem&&(this.elem.style.width=t)}},{key:"setStyleName",value:function(t){this.styleName=t,this.elem&&(this.elem.className=t)}},{key:"setStyle",value:function(t){this.style=t,this.elem&&s.objToStyle(this.elem,t)}},{key:"setCursor",value:function(t){this.elem&&(this.elem.style.cursor=t)}},{key:"setTop",value:function(t){this.elem&&(this.elem.style.top=t)}},{key:"setLeft",value:function(t){this.elem&&(this.elem.style.left=t)}},{key:"offsetLeft",value:function(){return this.elem?this.elem.offsetLeft:0}},{key:"offsetTop",value:function(){return this.elem?this.elem.offsetTop:0}},{key:"offsetWidth",value:function(){return this.elem?this.elem.offsetWidth:0}},{key:"offsetHeight",value:function(){return this.elem?this.elem.offsetHeight:0}},{key:"getBoundingClientRect",value:function(){return this.elem?this.elem.getBoundingClientRect():null}},{key:"setScrollTop",value:function(t){this.elem&&(this.elem.scrollHeight<=this.elem.clientHeight+this.elem.scrollTop||(this.elem.scrollTop=this.elem.scrollTop+t))}},{key:"scrollBy",value:function(t){this.elem&&(this.elem.scrollHeight<=this.elem.clientHeight+this.elem.scrollTop||this.elem&&this.elem.scrollBy({left:0,top:t,behavior:"smooth"}))}},{key:"scrollTo",value:function(t){this.elem&&(this.elem.scrollHeight<=this.elem.clientHeight+this.elem.scrollTop||this.elem&&this.elem.scrollTo({left:0,top:t,behavior:"smooth"}))}},{key:"isContainer",value:function(){return!0}},{key:"_render",value:function(){var t=document.createElement("div");return this.id&&t.setAttribute("id",this.id),this.styleName&&(t.className=this.styleName),this.style&&s.objToStyle(t,this.style),this.children.forEach((function(e){try{t.appendChild(e.render())}catch(t){console.error("appendChild err:",t),console.log("child class: "+e.constructor.name)}})),t}}]),n}(L),j=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.styleName,i=t.url,a=t.id,u=void 0===a?"":a,l=t.onready,c=void 0===l?void 0:l;return S(this,n),(r=e.call(this,{styleName:o,id:u,onready:c})).url=i,r}return P(n,[{key:"setImageUrl",value:function(t){this.url=t,this.elem&&(this.elem.src=this.url)}},{key:"_render",value:function(){var t=document.createElement("img");return t.src=this.url,this.styleName&&(t.className=this.styleName),t}}]),n}(L),I=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.styleName,i=t.id,a=void 0===i?"":i,u=t.name,l=void 0===u?"":u,c=t.value,s=void 0===c?"":c,d=t.style,f=t.onready,h=void 0===f?void 0:f,y=t.onChange;return S(this,n),(r=e.call(this,{styleName:o,id:a,onready:h})).name=l,r.value=s,r.onChange=y,r.style=d,r}return P(n,[{key:"type",value:function(){return""}},{key:"setValue",value:function(t){this.value=t,this.elem&&(this.elem.value=t)}},{key:"_render",value:function(){var t=this,e=document.createElement("input");return e.setAttribute("type",this.type()),e.setAttribute("name",this.name),e.setAttribute("value",this.value),this.onChange&&(e.onchange=function(){t.onChange(e.value)}),this.styleName&&(e.className=this.styleName),this.style&&s.objToStyle(e,this.style),e}}]),n}(L),N=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.styleName,i=t.style,a=t.id,u=void 0===a?"":a,l=t.name,c=void 0===l?"":l,s=t.value,d=void 0===s?"":s,f=t.placeholder,h=t.onready,y=t.onChange;return S(this,n),(r=e.call(this,{styleName:o,style:i,id:u,name:c,value:d,onready:h,onChange:y})).placeholder=f,r}return P(n,[{key:"type",value:function(){return"text"}},{key:"_render",value:function(){var t=v(x(n.prototype),"_render",this).call(this);return this.placeholder&&t.setAttribute("placeholder",this.placeholder),t}}]),n}(I),B=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.styleName,i=t.id,a=void 0===i?"":i,u=t.name,l=void 0===u?"":u,c=t.value,s=void 0===c?"":c,d=t.style,f=t.onready,h=t.onChange;return S(this,n),(r=e.call(this,{styleName:o,id:a,name:l,style:d,value:s,onready:f})).onChange=h,r}return P(n,[{key:"type",value:function(){return"file"}},{key:"filter",value:function(){return"image/*"}},{key:"_render",value:function(){var t=this,e=v(x(n.prototype),"_render",this).call(this);return e.setAttribute("accept",this.filter()),this.onChange&&(e.onchange=function(){t.onChange(e.files[0])}),e}}]),n}(I),A=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.styleName,i=void 0===o?"":o,a=t.id,u=void 0===a?"":a,l=t.name,c=void 0===l?"":l,s=t.value,d=void 0===s?"":s,f=t.checked,h=void 0!==f&&f,y=t.onClick,p=t.onready,v=void 0===p?void 0:p;return S(this,n),(r=e.call(this,{styleName:i,id:u,name:c,value:d,onready:v})).onClick=y,r.checked=h,r}return P(n,[{key:"type",value:function(){return"checkbox"}},{key:"isChecked",value:function(){return!!this.elem&&this.elem.checked}},{key:"_render",value:function(){var t=v(x(n.prototype),"_render",this).call(this);return this.onClick&&(t.onclick=this.onClick),this.checked&&(t.checked=this.checked),this.id&&(t.id=this.id),t}}]),n}(I),R=function(t){b(n,t);var e=k(n);function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return S(this,n),(r=e.call(this,{styleName:"",id:"",onready:o})).text=t,r}return P(n,[{key:"setText",value:function(t){this.elem&&(this.elem.textContent=t)}},{key:"_render",value:function(){return document.createTextNode(this.text)}}]),n}(L),M=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.oncanplay,i=t.onplay,a=t.onended,u=t.onprogress,l=t.ontimeupdate,c=t.onready;return S(this,n),(r=e.call(this,{styleName:"",id:"",onready:c})).oncanplay=o,r.onplay=i,r.onended=a,r.onprogress=u,r.ontimeupdate=l,r}return P(n,[{key:"seekTo",value:function(t){this.elem&&(this.elem.currentTime=t*this.elem.duration)}},{key:"currentTime",value:function(){return this.elem&&this.elem.currentTime}},{key:"duration",value:function(){return this.elem&&this.elem.duration}},{key:"hasUrl",value:function(){return this.elem&&this.elem.src}},{key:"setPlayUrl",value:function(t){this.elem&&(this.elem.src=t)}},{key:"play",value:function(){this.elem&&this.elem.play()}},{key:"pause",value:function(){this.elem&&this.elem.pause()}},{key:"setVolume",value:function(t){this.elem&&(this.elem.volume=t)}},{key:"_render",value:function(){var t=document.createElement("audio");return t.setAttribute("preload","auto"),t.oncanplay=function(){console.log("on audio prepared duration="+t.duration)},t.onplay=this.onplay,t.onended=this.onended,t.onprogress=this.onprogress,t.ontimeupdate=this.ontimeupdate,t.onerror=t.onended,this.elem=t,this.onready&&this.onready(this),t}}]),n}(L),F=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.forId,i=t.styleName;return S(this,n),(r=e.call(this,{styleName:i,id:""})).forId=o,r}return P(n,[{key:"_render",value:function(){var t=document.createElement("label");return this.forId&&t.setAttribute("for",this.forId),this.styleName&&(t.className=this.styleName),t}}]),n}(L),D=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.onTap,i=void 0===o?void 0:o,a=t.onHover,u=void 0===a?void 0:a,l=t.onTouchStart,c=void 0===l?void 0:l,s=t.onTouchEnd,d=void 0===s?void 0:s,f=t.onMouseDown,h=void 0===f?void 0:f,y=t.onMouseUp,p=void 0===y?void 0:y,v=t.child;return S(this,n),(r=e.call(this,{styleName:"",id:""})).onTap=i,r.onHover=u,r.child=v,r.onTouchStart=c,r.onTouchEnd=d,r.onMouseDown=h,r.onMouseUp=p,r}return P(n,[{key:"build",value:function(){return this.child}},{key:"_render",value:function(){var t=this.child.render();return this.onTap&&(t.onclick=this.onTap),this.onHover&&(t.onmouseover=this.onHover),this.onMouseDown&&(t.onmousedown=this.onMouseDown),this.onMouseUp&&(t.onmouseup=this.onMouseUp),this.onTouchStart&&(t.ontouchstart=this.onTouchStart),this.onTouchEnd&&(t.ontouchend=this.onTouchEnd),t}}]),n}(T),V=function(t){b(n,t);var e=k(n);function n(t){var r,o=t.width,i=void 0===o?0:o,a=t.height,u=void 0===a?0:a,l=t.onready,c=void 0===l?void 0:l;return S(this,n),(r=e.call(this,{styleName:"",id:"",onready:c})).width=i,r.height=u,r}return P(n,[{key:"setCanvasSize",value:function(t,e){this.width=t,this.height=e,this.elem&&(this.elem.width=this.width,this.elem.height=this.height)}},{key:"imageData",value:function(){return this.context?this.context.getImageData(0,0,this.width,this.height):null}},{key:"putImageData",value:function(t,e,n){this.context&&this.context.putImageData(t,e,n)}},{key:"_render",value:function(){var t=document.createElement(l);return t.width=this.width,t.height=this.height,this.context=t.getContext("2d"),t}}]),n}(L),W=function(){function t(){S(this,t)}return P(t,null,[{key:"init",value:function(){t._root=document.getElementById("root"),window.onpopstate=function(e){console.log("onpopstate e = ",e.state),t.pop()}}},{key:"push",value:function(e){var n=e.page,r=e.path,o=e.title;if(t._root&&n){var i=n();if(i instanceof L){t._stack.push(i);var a=t._root;t._removeAll(t._root),a.appendChild(i.render()),history.pushState({title:o,path:r},o,r)}}}},{key:"_removeAll",value:function(t){for(;t.hasChildNodes();)t.removeChild(t.lastChild)}},{key:"pop",value:function(){if(t._root&&!(t._stack.length<=1)){var e=t._root;t._removeAll(e);var n=t._stack,r=n.splice(n.length-1,1);if(r)for(var o=0;o<r.length;o++)r[o].disposeWidget();n.length>0&&e.appendChild(n[n.length-1].render())}}},{key:"replace",value:function(e){var n=e.page,r=e.path,o=e.title;if(0==t._stack.length&&t.push({page:n,path:r,title:o}),t._root&&n){var i=n();if(i instanceof L){var a=t._stack[t._stack.length-1];a&&a.disposeWidget(),t._stack[t._stack.length-1]=i;var u=t._root;t._removeAll(t._root),u.appendChild(i.render()),history.replaceState({title:o,path:r},o,r)}}}}]),t}();p(W,"_root",void 0),p(W,"_stack",[]);var U=function(){function t(){S(this,t)}return P(t,null,[{key:"addEvent",value:function(e,n){if(e&&n){var r=t._events[e];r||(r=[],t._events[e]=r),r.push(n)}}},{key:"removeAll",value:function(){_events={}}},{key:"removeEvent",value:function(e,n){if(e&&n){var r=t._events[e];if(r&&0!=r.length)for(var o=0;o<r.length;o++)if(r[o]==n){r.splice(o,1);break}}}},{key:"sendEvent",value:function(e,n){var r=t._events[e];r&&r instanceof Array&&r.forEach((function(t){t(n)}))}}]),t}();p(U,"_events",{});var H,G=function(){function t(e,n){S(this,t),this.oldWidget=e,this.newWidget=n}return P(t,[{key:"diff",value:function(){this.oldWidget.initProps&&(this.newWidget.initProps=this.oldWidget.initProps),t.rebuild(this.newWidget);var e=this.oldWidget.child,n=this.newWidget.child;this.diffImpl(e,n,this.oldWidget)}},{key:"diffImpl",value:function(t,e,n){try{if(t.classType()!=e.classType())return void this._replaceWidget(t,e,n)}catch(t){console.error("compare type",t)}if(t.isContainer()){var r=e.children,o=t.children,i=o.length;if(r.length<o.length){for(var a=r.length;a<o.length;a++)t.elem.removeChild(o[a].elem);o.splice(r.length,o.length-r.length)}else if(r.length>o.length){for(var u=o.length;u<r.length;u++)t.elem.appendChild(r[u].render());o.push.apply(o,r.slice(o.length,r.length))}for(var l=r.length>i?i:r.length,c=0;c<l;c++)this.diffImpl(o[c],r[c],t);try{e.styleName!=t.styleName&&t.setStyleName(e.styleName),e.style!=t.style&&t.setStyle(e.style)}catch(t){console.error("set class name error",t)}}else if(t.isComponent()){this.oldWidget.initProps&&(this.newWidget.initProps=this.oldWidget.initProps);var s=t.child,d=e.child;this.diffImpl(s,d,t)}}},{key:"_replaceWidget",value:function(t,e,n){if(n.isContainer()){var r=n.children.indexOf(t);n.children[r]=e,n.elem&&n.elem.replaceChild(e.render(),t.elem)}else n.isComponent()&&(n.child=e,t.elem&&t.elem.parentNode&&t.elem.parentNode.replaceChild(e.render(),t.elem));t.disposeWidget()}}],[{key:"rebuild",value:function(e){e.isContainer()?e.children.forEach((function(e){e.isComponent()?t.rebuild(e.rebuild()):e.isContainer()&&t.rebuild(e)})):e.isComponent()?t.rebuild(e.rebuild()):console.log("other type")}},{key:"isBoyiaWidget",value:function(t){return t instanceof L}},{key:"cloneWidget",value:function(e){if(!t.isBoyiaWidget(e))throw new Error("obj is not a boyia widget");var n=new e.constructor({styleName:e.styleName,onready:e.onready});for(var r in e)n[r]=e[r];return n}}]),t}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,q(r.key),r)}}function X(t,e,n){return(e=q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q(t){var e=function(t,e){if("object"!==z(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===z(e)?e:String(e)}var J=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"fetchPromise",value:function(e){var n=e.url,r=e.method,o=void 0===r?t.HttpMethod.get:r,i=e.headers,a=void 0===i?{}:i,u=e.data,l=e.responseType,c=void 0===l?"json":l;return new Promise((function(e,r){t.fetch({url:n,method:o,headers:a,data:u,responseType:c,success:function(t){e({status:"ok",data:t})},fail:function(t){r({status:"fail",reason:t})}})}))}},{key:"fetch",value:function(e){var n=e.url,r=e.method,o=void 0===r?t.HttpMethod.get:r,i=e.headers,a=void 0===i?{}:i,u=e.data,l=e.responseType,c=void 0===l?"json":l,s=e.success,d=e.fail,f=e.uploadProgress,h=e.onLoad;u=u||{};var y=t._methodMap[o](a,u);console.log("reqData = ",y),o===t.HttpMethod.get&&(n+=y);var p=new XMLHttpRequest;p.responseType=c,"blob"==c?h&&(p.onload=function(t){200==p.status&&h(t,p)}):p.onreadystatechange=function(){4===p.readyState&&(200===p.status?s&&"function"==typeof s&&s(p.response):d&&"function"==typeof d&&d(p.status))},f&&(p.upload.onprogress=function(t){t.lengthComputable&&f(t.loaded,t.total)}),p.open(o,n,!0),Object.keys(a).forEach((function(t){p.setRequestHeader(t,a[t])})),p.send(o===t.HttpMethod.post?y:null)}},{key:"_getPostJsonData",value:function(t){return JSON.stringify(t)}},{key:"_getPostFormData",value:function(t){if(0==Object.keys(t).length)return"";var e=[];for(var n in t)e.push("".concat(n,"=",t[n]));return e.join("&")}},{key:"_httpGetData",value:function(t,e){return 0==Object.keys(e).length?"":0===location.search.length?"".concat("?",e):"".concat("&",e)}},{key:"_httpPostData",value:function(e,n){var r=t._postMap[e["Content-Type"]];return r?r(n):n}},{key:"upload",value:function(e){var n=e.url,r=e.headers,o=void 0===r?{}:r,i=e.file,a=e.success,u=e.fail,l=e.uploadProgress,c=new FormData;c.append("file",i),t.fetch({url:n,headers:o,data:c,method:t.HttpMethod.post,success:a,fail:u,uploadProgress:l})}},{key:"download",value:function(e){var n=e.url,r=e.headers,o=void 0===r?{}:r;t.fetch({url:n,headers:o,responseType:"blob",method:t.HttpMethod.get,onLoad:function(t,e){var n=new Blob([e.response],{type:"application/octet-stream"}),r=e.getResponseHeader("Content-Disposition"),o=document.createElement("a"),i="unknow";if(r){var a=r.split("=");i=decodeURI(a[1])}console.log("BoyiaHttp download file name = "+i),o.href=window.URL.createObjectURL(n),o.download=i,o.click(),o.remove(),window.URL.revokeObjectURL(o.href)}})}}],null&&Y(e.prototype,null),n&&Y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function Q(t){return function(t){if(Array.isArray(t))return Z(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tt(){tt=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,o){var i=e&&e.prototype instanceof f?e:f,a=Object.create(i.prototype),u=new P(o||[]);return r(a,"_invoke",{value:k(t,n,u)}),a}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d={};function f(){}function h(){}function y(){}var p={};l(p,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(C([])));m&&m!==e&&n.call(m,i)&&(p=m);var g=y.prototype=f.prototype=Object.create(p);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(r,i,a,u){var l=s(t[r],t,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==K(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(d).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,u)}))}u(l.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function k(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var u=x(a,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=y,r(g,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:h,configurable:!0}),h.displayName=l(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(w.prototype),l(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),l(g,u,"Generator"),l(g,i,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=C,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function et(t,e,n,r,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void n(t)}u.done?e(l):Promise.resolve(l).then(r,o)}function nt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){et(i,r,o,a,u,"next",t)}function u(t){et(i,r,o,a,u,"throw",t)}a(void 0)}))}}function rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,it(r.key),r)}}function ot(t,e,n){return(e=it(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function it(t){var e=function(t,e){if("object"!==K(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===K(e)?e:String(e)}X(J,"HttpMethod",{get:"GET",post:"POST"}),X(J,"_postMap",{"application/x-www-form-urlencoded":J._getPostFormData,"application/json":J._getPostJsonData}),X(J,"_methodMap",(X(H={},J.HttpMethod.get,J._httpGetData),X(H,J.HttpMethod.post,J._httpPostData),H));var at="User-Token",ut="audio",lt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r,o,i,a,u;return e=t,null,n=[{key:"clear",value:function(){t.audioData=null,d.removeData(ut)}},{key:"_getData",value:function(){var e;return t.audioData||(t.audioData=null!==(e=d.getObject(ut))&&void 0!==e?e:{}),t.audioData}},{key:"getVolume",value:function(){var t;return null!==(t=this._getData().volume)&&void 0!==t?t:1}},{key:"setVolume",value:function(t){var e=this._getData();e.volume=t,s.asyncTask({macroTask:function(){d.setObject(ut,e)}})}},{key:"isTuneCirculation",value:function(){var t;return null!==(t=this._getData().isTuneCirculation)&&void 0!==t&&t}},{key:"setTuneCirculation",value:(u=nt(tt().mark((function t(e){var n;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=this._getData()).isTuneCirculation=e,t.next=4,s.asyncTaskPromise({macroTask:function(){d.setObject(ut,n)}});case 4:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"getLocalPlaylist",value:function(){var t;return null!==(t=this._getData().playlist)&&void 0!==t?t:[]}},{key:"getInternetPlaylist",value:function(){var e;return null!==(e=t.internetPlaylist)&&void 0!==e?e:[]}},{key:"getPlaylist",value:(a=nt(tt().mark((function e(n){var r,o,i,a;return tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.getLocalPlaylist(),0!=(o=t.getInternetPlaylist()).length||!n){e.next=7;break}return e.next=5,J.fetchPromise({url:n,headers:ot({},at,"none"),method:J.HttpMethod.get});case 5:"ok"==(i=e.sent).status&&(console.log("playlist data = ",i),o=null!==(a=i.data)&&void 0!==a?a:[],t.internetPlaylist=o);case 7:return r=[].concat(Q(o),Q(r)),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)}))),function(t){return a.apply(this,arguments)})},{key:"setLocalPlaylist",value:(i=nt(tt().mark((function t(e){var n;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=this._getData()).playlist=e,t.next=4,s.asyncTaskPromise({macroTask:function(){d.setObject(ut,n)}});case 4:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"deletePlayItem",value:(o=nt(tt().mark((function e(n){var r,o;return tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=(r=t.getLocalPlaylist()).length){e.next=3;break}return e.abrupt("return");case 3:o=0;case 4:if(!(o<r.length)){e.next=11;break}if(r[o].playId!=n){e.next=8;break}return r.splice(o,1),e.abrupt("break",11);case 8:o++,e.next=4;break;case 11:return e.next=13,t.setLocalPlaylist(r);case 13:case"end":return e.stop()}}),e)}))),function(t){return o.apply(this,arguments)})},{key:"getSkin",value:function(){var t;return null!==(t=this._getData().skin)&&void 0!==t?t:"black"}},{key:"setSkin",value:(r=nt(tt().mark((function t(e){var n;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=this._getData()).skin=e,t.next=4,s.asyncTaskPromise({macroTask:function(){d.setObject(ut,n)}});case 4:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}],n&&rt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ct(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ct(o)?o:String(o)),r)}var o}ot(lt,"audioData",null),ot(lt,"internetPlaylist",null);var dt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.skinMap={},this.register({name:"black",style:{audioPlayer:"audio-player-black",audioContainerBlink:"audio-container-blink-black",audioButton:"audio-button-black",audioPlayButton:"audio-play-button-black",audioPlayPause:"audio-play-pause-black",audioPlayForwardFirst:"audio-forward-first-black",audioPlayForward:"audio-forward-black",audioBack:"audio-back-black",audioBackFirst:"audio-back-first-black",audioLayout:"audio-layout-black",audioButtonContainer:"audio-button-container-black",audioBottom:"audio-bottom-black",audioProgressCtrl:"audio-progress-ctrl-black",audioProgressContainer:"audio-progress-container-black",audioProgress:"audio-progress-black",audioImageContainer:"audio-image-container-black",audioImage:"audio-image-black",audioHeader:"audio-header-black",audioTitleContainer:"audio-title-container-black",audioTitleText:"audio-title-text-black",audioProgressText:"audio-progress-text-black",audioPlaylistShow:"audio-playlist-show-black",audioPlaylistContainer:"audio-playlist-container-black",audioPlaylistContainerHide:"audio-playlist-container-hide-black",audioPlaylistItem:"audio-playlist-item-black",audioPlaylistEvenItem:"audio-playlist-even-item-black",audioItemIndex:"audio-item-index-black",audioItemName:"audio-item-name-black",audioItemAuthor:"audio-item-author-black",audioItemFocus:"audio-item-name-focus-black",audioListButtonContainer:"audio-list-button-container-black",audioListButtonStyle:"audio-list-button-style-black",audioVolumeIconFirst:"audio-volume-icon-first-black",audioVolumeIcon:"audio-volume-icon-black",audioVolumeView:"audio-volume-view-black",audioVolumeProgress:"audio-volume-progress-black",audioVolumeBar:"audio-volume-bar-black",audioVolumeIconContainer:"audio-volume-icon-container-black",audioVolumeContainer:"audio-volume-container-black",audioLyricButtonContainer:"audio-lyric-button-container-black",audioLyricsContainer:"audio-lyrics-container-black",audioLyricItem:"audio-lyric-item-black",audioLyricRoot:"audio-lyrics-root-black",audioLyricShow:"audio-lyric-show-black",audioShadowTop:"audio-shadow-top-black",audioShadowBottom:"audio-shadow-bottom-black",audioLyricItemFocus:"audio-lyric-item-focus-black",audioNoLyricTip:"audio-no-lyric-tip-black",audioEffectContainer:"effect-container-black",audioPlaylistRoot:"audio-playlist-root-black",audioSettingButtonContainer:"audio-setting-button-container-black",audioSettingButtonOuter:"audio-setting-button-outer-black",audioSettingButtonInner:"audio-setting-button-inner-black",audioSettingsContainer:"audio-settings-container-black",audioSwitchStyle:"audio-bui-switch",audioAddSongRoot:"audio-add-song-root-black",audioAddSongContainer:"audio-add-song-container-black",audioAddSongClose:"audio-add-song-container-close-black",audioAddSongInput:"audio-add-song-input-black"}}),this.register({name:"default",style:{audioPlayer:"audio-player",audioContainerBlink:"audio-container-blink",audioButton:"audio-button",audioPlayButton:"audio-play-button",audioPlayPause:"audio-play-pause",audioPlayForwardFirst:"audio-forward-first",audioPlayForward:"audio-forward",audioBack:"audio-back",audioBackFirst:"audio-back-first",audioLayout:"audio-layout",audioButtonContainer:"audio-button-container",audioBottom:"audio-bottom",audioProgressCtrl:"audio-progress-ctrl",audioProgressContainer:"audio-progress-container",audioProgress:"audio-progress",audioImageContainer:"audio-image-container",audioImage:"audio-image",audioHeader:"audio-header",audioTitleContainer:"audio-title-container",audioTitleText:"audio-title-text",audioProgressText:"audio-progress-text",audioPlaylistShow:"audio-playlist-show",audioPlaylistContainer:"audio-playlist-container",audioPlaylistContainerHide:"audio-playlist-container-hide",audioPlaylistItem:"audio-playlist-item",audioPlaylistEvenItem:"audio-playlist-even-item",audioItemIndex:"audio-item-index",audioItemName:"audio-item-name",audioItemAuthor:"audio-item-author",audioItemFocus:"audio-item-name-focus",audioListButtonContainer:"audio-list-button-container",audioListButtonStyle:"audio-list-button-style",audioVolumeIconFirst:"audio-volume-icon-first",audioVolumeIcon:"audio-volume-icon",audioVolumeView:"audio-volume-view",audioVolumeProgress:"audio-volume-progress",audioVolumeBar:"audio-volume-bar",audioVolumeIconContainer:"audio-volume-icon-container",audioVolumeContainer:"audio-volume-container",audioLyricButtonContainer:"audio-lyric-button-container",audioLyricsContainer:"audio-lyrics-container",audioLyricItem:"audio-lyric-item",audioLyricRoot:"audio-lyrics-root",audioLyricShow:"audio-lyric-show",audioShadowTop:"audio-shadow-top",audioShadowBottom:"audio-shadow-bottom",audioLyricItemFocus:"audio-lyric-item-focus",audioNoLyricTip:"audio-no-lyric-tip",audioEffectContainer:"effect-container",audioPlaylistRoot:"audio-playlist-root",audioSettingButtonContainer:"audio-setting-button-container",audioSettingButtonOuter:"audio-setting-button-outer",audioSettingButtonInner:"audio-setting-button-inner",audioSettingsContainer:"audio-settings-container",audioSwitchStyle:"audio-bui-switch",audioAddSongRoot:"audio-add-song-root",audioAddSongContainer:"audio-add-song-container",audioAddSongClose:"audio-add-song-container-close",audioAddSongInput:"audio-add-song-input"}});var e=lt.getSkin();this.setSkin(e)}var e,n,r;return e=t,r=[{key:"instance",value:function(){return t.sInstance||(t.sInstance=new t),t.sInstance}}],(n=[{key:"getSkin",value:function(){return this.skin||(this.skin=this.skinMap[this.skinName]),this.skin}},{key:"register",value:function(t){console.log("SkinManager.js---register name="+t.name+" style="+t.style),this.skinMap[t.name]=t.style}},{key:"setSkin",value:function(t){lt.setSkin(t);var e=this.skinMap[t];e||(e=this.skinMap.black),this.skin=e}}])&&st(e.prototype,n),r&&st(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function ht(){return ht="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=mt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ht.apply(this,arguments)}function yt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pt(t,e)}function pt(t,e){return pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pt(t,e)}function vt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=mt(t);if(e){var o=mt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function mt(t){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mt(t)}function gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kt(r.key),r)}}function wt(t,e,n){return e&&bt(t.prototype,e),n&&bt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kt(t){var e=function(t,e){if("object"!==ft(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===ft(e)?e:String(e)}dt.sInstance=null;var xt,St,_t,Pt={kSpaceEffect:1,kNoEffect:2,kPillarEffect:3},Ct=250,Lt=function(){function t(e){gt(this,t),this._resetWidget(e)}return wt(t,[{key:"_resetWidget",value:function(t){this.widget=t,this.analyser=t.analyser,this.audio=t.audio,this.width=t.width,this.height=t.height}},{key:"render",value:function(){}}],[{key:"getRenderer",value:function(e,n){var r=t.effectRendererMap[e];return r?r._resetWidget(n):(r=t._createRenderer(e,n),t.effectRendererMap[e]=r),r}},{key:"_createRenderer",value:function(t,e){switch(t){case Pt.kPillarEffect:return new jt(e);case Pt.kSpaceEffect:return new Et(e);case Pt.kNoEffect:return new It(e)}return null}}]),t}();xt=Lt,_t={},(St=kt(St="effectRendererMap"))in xt?Object.defineProperty(xt,St,{value:_t,enumerable:!0,configurable:!0,writable:!0}):xt[St]=_t;var Tt=2*Math.PI,Ot=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.45;t.r<e&&(t.r=e),t.g<e&&(t.g=e),t.b<e&&(t.b=e)},Et=function(t){yt(n,t);var e=vt(n);function n(t){var r;return gt(this,n),(r=e.call(this,t))._initResource(),r}return wt(n,[{key:"render",value:function(){this._renderEffect(),this.context&&this.context.putImageData(this.imageData,0,0)}},{key:"_resetWidget",value:function(t){ht(mt(n.prototype),"_resetWidget",this).call(this,t),this.context=t.canvasWidget.context,this.imageData=t.imageData,this.analyser.fftSize=8192}},{key:"_setPixel",value:function(t,e,n,r,o,i){var a=4*(t+e*this.imageData.width),u=this.imageData.data;u[a]=n,u[a+1]=r,u[a+2]=o,u[a+3]=i}},{key:"_initResource",value:function(){var t={};t.r=Math.random()*Tt,t.g=Math.random()*Tt,t.b=Math.random()*Tt;var e={};e.r=Math.random()*Tt,e.g=Math.random()*Tt,e.b=Math.random()*Tt,this.color=t,this.mixColor=e,this.time=0,this.colorInvertValue=0,this._addCircles()}},{key:"_renderEffect",value:function(){var t=!1;this.analyser&&(t=!0);var e=null;t&&(e=new Uint8Array(this.analyser.frequencyBinCount),this.analyser.getByteFrequencyData(e));var n,r=(n=this.color,{r:1*Math.sin(n.r+=.04)+1,g:1*Math.sin(n.g+=.028)+1,b:1*Math.sin(n.b+=.052)+1}),o=function(t){return{r:1*Math.sin(t.r+=.01)+1,g:1*Math.sin(t.g+=.007)+1,b:1*Math.sin(t.b+=.013)+1}}(this.mixColor);Ot(r,.45),Ot(o,.25);for(var i=!1,a=this.circleHolder,u=0,l=a.length;u<l;u++){var c=a[u];c.color.r=r.r-(c.z+Ct)/Ct,c.color.g=r.g-(c.z+Ct)/Ct,c.color.b=r.b-(c.z+Ct)/Ct,c.color.r<o.r&&(c.color.r=o.r),c.color.g<o.g&&(c.color.g=o.g),c.color.b<o.b&&(c.color.b=o.b);var s=void 0;u>0&&(s=a[u-1]),c.mp.x+=25e-5*(this.width/2-c.mp.x),c.mp.y+=25e-5*(this.height/2-c.mp.y),c.center.x=(this.width/2-c.mp.x)*((c.z-Ct)/500)+this.width/2,c.center.y=(this.height/2-c.mp.y)*((c.z-Ct)/500)+this.height/2;for(var d=0,f=c.segmentsOutside.length;d<f;d++){var h=c.segmentsOutside[d];if(!0===h.active){var y=Ct/(Ct+c.z),p=void 0;u>0&&(p=Ct/(Ct+s.z));var v=void 0,m=void 0;h.x2d=h.x*y+c.center.x,h.y2d=h.y*y+c.center.y,t&&(m=(v=e[h.audioBufferIndex])/20,h.radiusAudio=h.radius-m);var g=0;if(d>0&&(t&&!1===this.audio.paused?(g=Math.round(u/l*(55+v)))>255&&(g=255):g=Math.round(u/l*200)),u>0&&u<l-1){var b=h.subs[0],w=b.index*(Tt/h.segments)+this.time;b.x2d=b.x*y+c.center.x,b.y2d=b.y*y+c.center.y,b.x=c.circleCenter.x+Math.cos(w)*h.radiusAudio,b.y=c.circleCenter.y+Math.sin(w)*h.radiusAudio;var k=h.subs[1],x=k.index*(Tt/h.segments)+this.time;k.x2d=k.x*p+s.center.x,k.y2d=k.y*p+s.center.y,k.x=c.circleCenter.x+Math.cos(x)*h.radiusAudio,k.y=c.circleCenter.y+Math.sin(x)*h.radiusAudio;var S=h.subs[2],_=S.index*(Tt/h.segments)+this.time;S.x2d=S.x*p+s.center.x,S.y2d=S.y*p+s.center.y,S.x=c.circleCenter.x+Math.cos(_)*h.radiusAudio,S.y=c.circleCenter.y+Math.sin(_)*h.radiusAudio;var P=h.subs[3],C=P.index*(Tt/h.segments)+this.time;P.x2d=P.x*y+c.center.x,P.y2d=P.y*y+c.center.y,P.x=c.circleCenter.x+Math.cos(C)*h.radius,P.y=c.circleCenter.y+Math.sin(C)*h.radius;var L=h.subs[4],T=L.index*(Tt/h.segments)+this.time;L.x2d=L.x*y+c.center.x,L.y2d=L.y*y+c.center.y,L.x=c.circleCenter.x+Math.cos(T)*h.radius,L.y=c.circleCenter.y+Math.sin(T)*h.radius;var O=h.subs[5],E=O.index*(Tt/h.segments)+this.time;O.x2d=O.x*p+s.center.x,O.y2d=O.y*p+s.center.y,O.x=c.circleCenter.x+Math.cos(E)*h.radius,O.y=c.circleCenter.y+Math.sin(E)*h.radius;var j=h.subs[6],I=j.index*(Tt/h.segments)+this.time;j.x2d=j.x*p+s.center.x,j.y2d=j.y*p+s.center.y,j.x=c.circleCenter.x+Math.cos(I)*h.radius,j.y=c.circleCenter.y+Math.sin(I)*h.radius;var N=void 0,B=void 0,A=void 0,R=void 0,M=h.subs[3],F=h.subs[4],D=h.subs[6],V=h.subs[5];m>0&&(N=h,B=h.subs[1],A=h.subs[2],R=h.subs[0]);var W=Math.round(c.color.r*g),U=Math.round(c.color.g*g),H=Math.round(c.color.b*g);m>0&&(this._drawLine(0|N.x2d,0|N.y2d,0|B.x2d,0|B.y2d,W,U,H,255),this._drawLine(0|B.x2d,0|B.y2d,0|A.x2d,0|A.y2d,W,U,H,255),this._drawLine(0|A.x2d,0|A.y2d,0|R.x2d,0|R.y2d,W,U,H,255),this._drawLine(0|R.x2d,0|R.y2d,0|N.x2d,0|N.y2d,W,U,H,255),this._drawLine(0|M.x2d,0|M.y2d,0|N.x2d,0|N.y2d,W,U,H,255),this._drawLine(0|F.x2d,0|F.y2d,0|R.x2d,0|R.y2d,W,U,H,255),this._drawLine(0|D.x2d,0|D.y2d,0|A.x2d,0|A.y2d,W,U,H,255),this._drawLine(0|V.x2d,0|V.y2d,0|B.x2d,0|B.y2d,W,U,H,255)),c.z<125&&(this._drawLine(0|M.x2d,0|M.y2d,0|F.x2d,0|F.y2d,W,U,H,255),this._drawLine(0|F.x2d,0|F.y2d,0|D.x2d,0|D.y2d,W,U,H,255),this._drawLine(0|D.x2d,0|D.y2d,0|V.x2d,0|V.y2d,W,U,H,255),this._drawLine(0|V.x2d,0|V.y2d,0|M.x2d,0|M.y2d,W,U,H,255))}var G=h.index*(Tt/h.segments)+this.time;h.x=c.circleCenter.x+Math.cos(G)*h.radiusAudio,h.y=c.circleCenter.y+Math.sin(G)*h.radiusAudio}}c.z-=.75,c.z<-250&&(c.z+=500,i=!0)}i&&(a=a.sort((function(t,e){return e.z-t.z}))),this.time+=.005,this.colorInvertValue>0?this.colorInvertValue-=5:this.colorInvertValue=0,this.colorInvertValue>0&&this._dataInvert(this.colorInvertValue)}},{key:"_drawLine",value:function(t,e,n,r,o,i,a,u){for(var l=Math.abs(n-t),c=Math.abs(r-e),s=t<n?1:-1,d=e<r?1:-1,f=l-c,h=t,y=e;h>0&&h<this.width&&y>0&&y<this.height&&this._setPixel(h,y,o,i,a,u),h!==n||y!==r;){var p=2*f;p>-l&&(f-=c,h+=s),p<c&&(f+=l,y+=d)}}},{key:"_drawCircle",value:function(t,e,n){for(var r,o=[],i=0;i<=n;i++){var a=e;0===i&&(r=a),i===n&&(a=r);var u=t.x,l=t.y,c=this._getCirclePosition(u,l,a,i,n);o.push({x:c.x,y:c.y,index:i+0,radius:a,segments:n})}return o}},{key:"_getCirclePosition",value:function(t,e,n,r,o){var i=r*(Tt/o)+this.time;return{x:t+Math.cos(i)*n,y:e+Math.sin(i)*n}}},{key:"_addCircles",value:function(){for(var t=[],e=8,n={x:0,y:0},r={x:0,y:0},o=1,i=0,a={x:Math.random()*this.width,y:Math.random()*this.height},u=-250;u<Ct;u+=5){var l=this._drawCircle(n,16,64),c={segmentsOutside:[],segmentsInside:[],segmentsInside2:[],segmentsCount:0};c.index=i,c.z=u,c.center=r,c.circleCenter={x:0,y:0},c.mp={x:a.x,y:a.y},c.radius=l[0].radius,c.color={r:0,g:0,b:0},o=i%2,i++,e=Math.floor(1024*Math.random())+8;for(var s=void 0,d=0,f=l.length;d<f;d++){var h=l[d];if(d%2===o){(s=this._addCircleSegment(h.x,h.y,u,e)).active=!0,s.index=h.index,s.radius=h.radius,s.radiusAudio=s.radius,s.segments=h.segments,s.coordinates=[];var y;y=d>0?l[d-1]:l[f-1];var p=this._addCircleSegment(y.x,y.y,u,e),v=this._addCircleSegment(h.x,h.y,u-5,e),m=this._addCircleSegment(y.x,y.y,u-5,e),g=this._addCircleSegment(h.x,h.y,u,e),b=this._addCircleSegment(y.x,y.y,u,e),w=this._addCircleSegment(h.x,h.y,u-5,e),k=this._addCircleSegment(y.x,y.y,u-5,e);p.index=y.index,v.index=h.index,m.index=y.index,g.index=h.index,b.index=y.index,w.index=h.index,k.index=y.index,s.subs=[],s.subs.push(p,v,m,g,b,w,k),e=d<f-1?Math.floor(1024*Math.random())+8:c.segmentsOutside[0].audioBufferIndex,c.segmentsOutside.push(s)}else c.segmentsOutside.push({active:!1})}t.push(c)}this.circleHolder=t}},{key:"_addCircleSegment",value:function(t,e,n,r){var o={};return o.x=t,o.y=e,o.x2d=0,o.y2d=0,o.audioBufferIndex=r,o}}]),n}(Lt),jt=function(t){yt(n,t);var e=vt(n);function n(t){return gt(this,n),e.call(this,t)}return wt(n,[{key:"_resetWidget",value:function(t){ht(mt(n.prototype),"_resetWidget",this).call(this,t),this.analyser.fftSize=128,this.context=t.canvasWidget.context,this.leftOffset=0}},{key:"render",value:function(){this.analyser&&this.audio&&!1===this.audio.paused?this._renderEffect():this._renderDefault()}},{key:"_renderEffect",value:function(){var t=new Uint8Array(this.analyser.frequencyBinCount);if(this.analyser.getByteFrequencyData(t),t&&0!=t.length)if(0!=t[0]){this.leftOffset=0;var e=this.context;e.fillStyle="#000",e.fillRect(0,0,this.width,this.height);for(var n=this.analyser.frequencyBinCount,r=this.width/n,o=0,i=0;i<n;i++){var a=t[i]/255,u=i/n,l=this.height*a,c=128*a,s=243*u;e.fillStyle="rgb(".concat(c,",").concat(s,",").concat(240,")"),e.fillRect(o,this.height-l,r,l),o+=r+1}}else this._renderDefault()}},{key:"_renderDefault",value:function(){var t=.4*this.height,e=this.width/60,n=this.leftOffset,r=this.context;r.fillStyle="#000",r.fillRect(0,0,this.width,this.height);for(var o=0;o<0+this.width;o+=e+1){var i=Math.sin(.014*(o+0)+n),a=240*i,u=153*i;r.fillStyle="rgb(".concat(a,",").concat(u,",").concat(255,")");var l=t+i*this.height*.4;r.fillRect(o,this.height-l,e,l)}this.leftOffset+=.01}}]),n}(Lt),It=function(t){yt(n,t);var e=vt(n);function n(t){return gt(this,n),e.call(this,t)}return wt(n,[{key:"_resetWidget",value:function(t){ht(mt(n.prototype),"_resetWidget",this).call(this,t),this.analyser.fftSize=128,this.context=t.canvasWidget.context}},{key:"render",value:function(){var t=this.context;t.fillStyle="#00000033",t.fillRect(0,0,this.width,this.height)}}]),n}(Lt);function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ft(r.key),r)}}function At(t,e){return At=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},At(t,e)}function Rt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mt(t){return Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mt(t)}function Ft(t){var e=function(t,e){if("object"!==Nt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Nt(e)?e:String(e)}var Dt=Pt,Vt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&At(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Mt(r);if(o){var n=Mt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Nt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Rt(t)}(this,t)});function a(t){var e,n=t.volume,r=void 0===n?1:n,o=t.type,u=void 0===o?Pt.kPillarEffect:o,l=t.oncanplay,c=t.onplay,s=t.onended,d=t.onprogress,f=t.ontimeupdate,h=t.styleName,y=t.onready;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),function(t,e,n){(e=Ft(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(Rt(e=i.call(this,{styleName:h,onready:y})),"_animateEffect",(function(){e.renderer?(e._clearImageData(),e.renderer.render(),window.requestAnimationFrame(e._animateEffect)):e.initProps.effectRendering=!1})),e.oncanplay=l,e.onplay=c,e.onended=s,e.onprogress=d,e.ontimeupdate=f,e.type=u,e.effectPause=!1,e.volume=r,e}return e=a,(n=[{key:"initWidget",value:function(){this.initProps={effectRendering:!1}}},{key:"_createAudio",value:function(){var t=new Audio;t.preload=!0,t.loop=!1,t.autoplay=!0,t.volume=this.volume,t.oncanplay=function(){console.log("on audio prepared duration="+t.duration)},t.onplay=this.onplay,t.onended=this.onended,t.onprogress=this.onprogress,t.ontimeupdate=this.ontimeupdate,t.onerror=t.onended,this.audio=t}},{key:"setType",value:function(t){this.type=t,this.analyser&&(this.renderer=Lt.getRenderer(this.type,this))}},{key:"seekTo",value:function(t){this.audio&&(this.audio.currentTime=t*this.audio.duration)}},{key:"currentTime",value:function(){return this.audio&&this.audio.currentTime}},{key:"duration",value:function(){return this.audio&&this.audio.duration}},{key:"hasUrl",value:function(){return this.audio&&this.audio.src}},{key:"setPlayUrl",value:function(t){this.pause(),this._createAudio(),this.audio.src=t,0!==t.indexOf("http")&&this.createAudioAnalyser()}},{key:"play",value:function(){var t=this;this.audio&&s.asyncTask({macroTask:function(){t.initProps.effectRendering||(t.initProps.effectRendering=!0,t._animateEffect()),t.audio.play()}})}},{key:"pause",value:function(){this.audio&&this.audio.pause()}},{key:"setVolume",value:function(t){this.volume=t,this.audio&&(this.audio.volume=t)}},{key:"createAudioAnalyser",value:function(){var t=new f,e=t.createAnalyser();e.connect(t.destination),e.smoothingTimeConstant=.65,this.analyserBufferLength=e.frequencyBinCount;var n=t.createMediaElementSource(this.audio);n.connect(e),this.analyser=e,this.audioContext=t,this.audioSource=n,this.renderer=Lt.getRenderer(this.type,this)}},{key:"build",value:function(){var t=this;return new E({styleName:this.styleName,children:[new V({onready:function(e){t.canvasWidget=e}})],onready:function(e){t.canvasWidget&&s.asyncTask({macroTask:function(){t.width=e.offsetWidth(),t.height=e.offsetHeight(),t.canvasWidget.setCanvasSize(t.width,t.height),t.imageData=t.canvasWidget.imageData()}})}})}},{key:"_clearImageData",value:function(){for(var t=this.imageData.data,e=0;e<t.length;e+=4)t[e]=0,t[e+1]=0,t[e+2]=0,t[e+3]=255}}])&&Bt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(O);function Wt(t){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wt(t)}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ht(r.key),r)}}function Ht(t){var e=function(t,e){if("object"!==Wt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Wt(e)?e:String(e)}function Gt(t,e){return Gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Gt(t,e)}function zt(t){return zt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zt(t)}var Yt={titleContainer:{maxWidth:"100%",display:"inline-block",verticalAlign:"top",overflow:"hidden",whiteSpace:"nowrap"},titleContent:function(t){return{animation:"audio-playlist-title-scroll linear ".concat(t,"s alternate infinite"),float:"left"}}},Xt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gt(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=zt(r);if(o){var n=zt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Wt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e,n=t.text,r=t.focus,o=void 0!==r&&r,u=t.onready;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,{onready:u})).text=n,e.focus=o,e}return e=a,(n=[{key:"setFocus",value:function(t){this.focus=t,this.setState({})}},{key:"_buildFocusWidget",value:function(){var t=s.measureText(this.text,"1rem normal sans-serif");return new E({style:Yt.titleContainer,children:[new E({style:Yt.titleContent(t/40),children:[new R(this.text)]})]})}},{key:"build",value:function(){var t=dt.instance().getSkin(),e=this.focus?this._buildFocusWidget():new R(this.text);return new E({styleName:this.focus?t.audioItemFocus:t.audioItemName,children:[e]})}}])&&Ut(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(O);function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function Jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$t(r.key),r)}}function $t(t){var e=function(t,e){if("object"!==qt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===qt(e)?e:String(e)}function Kt(t,e){return Kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Kt(t,e)}function Qt(t){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qt(t)}var Zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kt(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Qt(r);if(o){var n=Qt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===qt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e,n=t.styleName,r=void 0===n?"bui-switch":n,o=t.theme,u=t.id,l=t.checked,c=void 0!==l&&l,s=t.onSwitchChecked;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,{styleName:r,id:u})).theme=o,e.onSwitchChecked=s,e.checked=c,e}return e=a,(n=[{key:"build",value:function(){var t=this;return new E({styleName:this.styleName,children:[new A({id:this.id,checked:this.checked,onClick:function(){t.checkbox&&t.onSwitchChecked&&t.onSwitchChecked(t.checkbox.isChecked())},onready:function(e){t.checkbox=e}}),new F({forId:this.id,styleName:this.theme})]})}}])&&Jt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(T);function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(){ee=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,o){var i=e&&e.prototype instanceof f?e:f,a=Object.create(i.prototype),u=new P(o||[]);return r(a,"_invoke",{value:k(t,n,u)}),a}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d={};function f(){}function h(){}function y(){}var p={};l(p,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(C([])));m&&m!==e&&n.call(m,i)&&(p=m);var g=y.prototype=f.prototype=Object.create(p);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(r,i,a,u){var l=s(t[r],t,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==te(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(d).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,u)}))}u(l.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function k(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var u=x(a,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=y,r(g,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:h,configurable:!0}),h.displayName=l(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(w.prototype),l(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),l(g,u,"Generator"),l(g,i,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=C,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function ne(t,e,n,r,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void n(t)}u.done?e(l):Promise.resolve(l).then(r,o)}function re(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ne(i,r,o,a,u,"next",t)}function u(t){ne(i,r,o,a,u,"throw",t)}a(void 0)}))}}function oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ue(r.key),r)}}function ae(t,e,n){return e&&ie(t.prototype,e),n&&ie(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ue(t){var e=function(t,e){if("object"!==te(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===te(e)?e:String(e)}function le(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ce(t,e)}function ce(t,e){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ce(t,e)}function se(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=fe(t);if(e){var o=fe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return de(t)}(this,n)}}function de(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fe(t){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fe(t)}var he="close_add_song",ye="play_list_refresh",pe="change_skin_refresh",ve=function(t){le(n,t);var e=se(n);function n(t){var r,o=t.onClick;return oe(this,n),(r=e.call(this,{})).onClick=o,r}return ae(n,[{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new D({onTap:function(){t.onClick&&t.onClick()},child:new E({styleName:e.audioSettingButtonContainer,children:[new E({styleName:e.audioSettingButtonInner})]})})}}]),n}(T),me="rem",ge={title:{color:"#FFFFFF",fontSize:"1.2".concat(me),marginBottom:"0.6".concat(me)},itemContainer:{width:"100%",borderRadius:"0.4rem",backgroundColor:"rgba(255, 255, 255, 0.1)",paddingLeft:"0.3rem",paddingRight:"0.3rem",paddingTop:"0.3rem",paddingBottom:"0.6rem",color:"rgba(255, 255, 255, 0.6)",fontSize:"1rem",marginTop:"0.3rem"},tuneContainer:{display:"flex",flexDirection:"row",alignItems:"center"},playlistHeaderContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},addPlayItemContainer:{width:"3rem",height:"2rem",textAlign:"center",lineHeight:"2rem",borderRadius:"0.6rem",backgroundColor:"rgba(255, 255, 255, 0.2)",cursor:"pointer"},audioPickerStyle:{position:"absolute",right:"0",top:"0",opacity:"0"},audioPickerContainerStyle:{backgroundColor:"rgba(255, 255, 255, 0.6)",height:"100%",width:"7rem",position:"relative",overflow:"hidden",color:"#000000EE",textAlign:"center",lineHeight:"3".concat(me),fontWeight:"900",fontSize:"1.2rem",cursor:"pointer"},songAddInputStyle:{width:"100%",height:"3".concat(me),borderRadius:"1.5".concat(me),border:"0.3".concat(me," solid rgba(255, 255, 255, 0.6)"),marginTop:"1".concat(me),display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"nowrap",alignItems:"center",overflow:"hidden",marginBottom:"0.6".concat(me)},songAddItemStyle:{width:"100%",height:"3".concat(me),borderRadius:"1.5".concat(me),border:"0.3".concat(me," solid rgba(255, 255, 255, 0.6)"),marginTop:"1".concat(me)},songAddHeaderStyle:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",boxSizing:"border-box"},songAddTitleStyle:{color:"rgba(255, 255, 255, 0.6)",fontSize:"1.2".concat(me),lineHeight:"100%"},songAddTextFieldStyle:{backgroundColor:"#FFFFFF00",border:"0 solid #FFFFFF00",caretColor:"#FFFFFF",outline:"none",height:"100%",width:"100%",color:"#FFFFFF",fontSize:"1.2rem",paddingLeft:"0.5rem"},playItemContainerStyle:{height:"2".concat(me),width:"100%",borderRadius:"1".concat(me),backgroundColor:"rgba(255, 255, 255, 0.2)",marginTop:"0.5".concat(me),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",color:"rgba(255, 255, 255, 0.6)",fontSize:"1rem",paddingLeft:"1rem",paddingRight:"1rem",boxSizing:"border-box"},playItemNameContainerStyle:{width:"100%",textAlign:"left",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},settingSkinRadioListContainer:function(t){return{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"999999rem",boxSizing:"border-box",paddingTop:"0.2rem",paddingBottom:"0.2rem",marginTop:"0.2rem",paddingLeft:"0.2rem",paddingRight:"0.2rem"}},settingSkinRadioContainer:{height:"1.8rem",width:"1.8rem",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",cursor:"pointer"},settingSkinRadioBorderStyle:function(t){return{position:"absolute",height:"1.8rem",width:"1.8rem",borderRadius:"50%",border:"0.2".concat(me," solid ").concat(t),boxSizing:"border-box"}},settingSkinRadioStyle:function(t){return{height:"1.2rem",width:"1.2rem",borderRadius:"50%",backgroundColor:t}}},be=[{color:"#000",skin:"black",backgroundColor:"#00000044"},{color:"rgb(108, 191, 255)",skin:"default",backgroundColor:"rgb(108, 191, 255, 0.2)"},{color:"#B22222",skin:"red",backgroundColor:"#B2222244"},{color:"#008B45",skin:"green",backgroundColor:"#008B4544"},{color:"#5D478B",skin:"purple",backgroundColor:"#5D478B44"},{color:"#8B2323",skin:"brown",backgroundColor:"#8B232344"},{color:"#CD3700",skin:"orange",backgroundColor:"#CD370044"}],we=function(t){le(n,t);var e=se(n);function n(t){var r,o=t.show,i=void 0!==o&&o,a=t.onAddSong,u=t.onready;return oe(this,n),(r=e.call(this,{onready:u})).show=i,r.onAddSong=a,r}return ae(n,[{key:"showSettings",value:function(t){this.show=t,this.setStateAsync({})}},{key:"initWidget",value:function(){this.initProps={origin:this}}},{key:"build",value:function(){if(!this.show)return new E({});var t=dt.instance().getSkin();return new E({styleName:t.audioLyricRoot,children:[this._buildSettingsContainer(t),new E({styleName:t.audioShadowTop}),new E({styleName:t.audioShadowBottom})]})}},{key:"_buildSettingsContainer",value:function(t){return new E({onready:function(t){},styleName:t.audioSettingsContainer,children:[this._buildSettingTitle(),this._buildSwitchItem({id:"tuneCirculation",title:"Tune circulation",skin:t,checked:lt.isTuneCirculation(),onSwitchChecked:function(t){lt.setTuneCirculation(t)}}),this._buildSwitchItem({id:"clearData",title:"Clear data",skin:t,onSwitchChecked:function(t){lt.clear(),U.sendEvent(ye)}}),this._buildSkinItem(),this._buildLocalPlaylist()]})}},{key:"_buildSettingTitle",value:function(){return new E({style:ge.title,children:[new R("Player Setting")]})}},{key:"_buildSwitchItem",value:function(t){var e=t.id,n=t.title,r=t.skin,o=t.checked,i=void 0!==o&&o,a=t.onSwitchChecked,u=s.extend({objs:[ge.itemContainer,ge.playlistHeaderContainer]});return new E({style:u,children:[new E({children:[new R(n)]}),new Zt({id:e,styleName:r.audioSwitchStyle,theme:"audio-bui-theme-blue",checked:i,onSwitchChecked:a})]})}},{key:"_buildLocalPlaylistItem",value:function(t){return new E({style:ge.playItemContainerStyle,children:[new E({style:ge.playItemNameContainerStyle,children:[new R("L".concat(t.playId,". ").concat(t.name))]}),new Se({onClose:(e=re(ee().mark((function e(){return ee().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lt.deletePlayItem(t.playId);case 2:U.sendEvent(ye);case 3:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})})]});var e}},{key:"_buildLocalPlaylistHeader",value:function(){var t=this;return new E({style:ge.playlistHeaderContainer,children:[new R("My playlist"),new D({onTap:function(){t.onAddSong&&t.onAddSong()},child:new E({style:ge.addPlayItemContainer,children:[new R("")]})})]})}},{key:"_buildLocalPlaylist",value:function(){var t=this,e=lt.getLocalPlaylist(),n=[];return e.forEach((function(e){n.push(t._buildLocalPlaylistItem(e))})),new E({style:ge.itemContainer,children:[this._buildLocalPlaylistHeader()].concat(n)})}},{key:"_buildSkinHeader",value:function(){return new E({style:ge.playlistHeaderContainer,children:[new R("Skin")]})}},{key:"_buildSkinItem",value:function(){return new E({style:ge.itemContainer,children:[this._buildSkinHeader(),this._buildSkinRadioList()]})}},{key:"_buildSkinRadioList",value:function(){var t=[];return be.forEach((function(e){t.push(new ke({info:e}))})),new E({style:ge.settingSkinRadioListContainer("#008B4544"),children:t})}}]),n}(O),ke=function(t){le(n,t);var e=se(n);function n(t){var r,o=t.info;return oe(this,n),(r=e.call(this,{})).info=o,r}return ae(n,[{key:"initWidget",value:function(){this.initProps={}}},{key:"setFocus",value:function(t){this.focus=t,this.setStateAsync({})}},{key:"build",value:function(){var t=this,e=lt.getSkin()==this.info.skin;return new D({onTap:function(){dt.instance().setSkin(t.info.skin),U.sendEvent(pe)},child:new E({style:ge.settingSkinRadioContainer,children:[new E({style:ge.settingSkinRadioStyle(this.info.color)}),new E({styleName:e?"audio-skin-radio-border-display":"audio-skin-radio-border",style:ge.settingSkinRadioBorderStyle(this.info.color)})]})})}}]),n}(O),xe=function(t){le(n,t);var e=se(n);function n(t){var r=t.styleName,o=t.id,i=void 0===o?"":o,a=t.name,u=void 0===a?"":a,l=t.value,c=void 0===l?"":l,s=t.style,d=t.onready,f=t.onChange;return oe(this,n),e.call(this,{styleName:r,id:i,name:u,value:c,style:s,onready:d,onChange:f})}return ae(n,[{key:"filter",value:function(){return"audio/*"}}]),n}(B),Se=function(t){le(n,t);var e=se(n);function n(t){var r,o=t.onClose;return oe(this,n),(r=e.call(this,{})).onClose=o,r}return ae(n,[{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new D({onTap:function(){t.onClose&&t.onClose()},child:new E({styleName:e.audioAddSongClose,children:[new R("")]})})}}]),n}(T),_e=function(t){le(n,t);var e=se(n);function n(t){var r,o=t.onready;return oe(this,n),function(t,e,n){(e=ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(de(r=e.call(this,{onready:o})),"show",(function(t){r.showSongAdd!=t&&(r.showSongAdd=t,r.playItem={imgUrl:"https://assets.market-storefront.envato-static.com/storefront/assets/logos/envato-market-a5ace93f8482e885ae008eb481b9451d379599dfed24868e52b6b2d66f5cf633.svg",name:"anonymous",author:"anonymous",local:!0},r.setStateAsync({}))})),r.showSongAdd=!1,r}return ae(n,[{key:"initWidget",value:function(){U.addEvent(he,this.show),this.initProps={}}},{key:"disposeWidget",value:function(){U.removeEvent(he,this.show)}},{key:"build",value:function(){var t=this;if(!this.showSongAdd)return new E({});var e=dt.instance().getSkin();return new E({styleName:e.audioAddSongRoot,children:[new E({styleName:e.audioAddSongContainer,children:[this._buildHeaderItem(),this._buildNormalItem({onChange:function(e){t.playItem.playUrl=e},placeholder:"Add your song url"}),this._buildNormalItem({title:"Add name",value:this.playItem.author,onChange:function(e){t.playItem.name=e}}),this._buildNormalItem({title:"Add author",value:this.playItem.author,onChange:function(e){t.playItem.author=e}}),this._buildSubmitItem({title:"Add image url",value:this.playItem.imgUrl,onChange:function(e){t.playItem.imgUrl=e}})]})]})}},{key:"_buildHeaderItem",value:function(){return new E({style:ge.songAddHeaderStyle,children:[new E({style:ge.songAddTitleStyle,children:[new R("Add your song")]}),new Se({onClose:function(){U.sendEvent(he,!1)}})]})}},{key:"_buildLocalSongItem",value:function(t,e,n){return new E({style:ge.songAddInputStyle,children:[new N({style:ge.songAddTextFieldStyle,onChange:t,onready:n}),new E({style:ge.audioPickerContainerStyle,children:[new R("Add"),new xe({style:ge.audioPickerStyle,onChange:e})]})]})}},{key:"_buildNormalItem",value:function(t){var e=t.title,n=t.value,r=t.placeholder,o=t.onChange,i=t.onready,a=dt.instance().getSkin();return new E(e?{children:[new E({style:ge.songAddTitleStyle,children:[new R(e)]}),new E({style:ge.songAddInputStyle,children:[new N({styleName:a.audioAddSongInput,style:ge.songAddTextFieldStyle,value:n,onChange:o,onready:i,placeholder:r})]})]}:{children:[new E({style:ge.songAddInputStyle,children:[new N({styleName:a.audioAddSongInput,style:ge.songAddTextFieldStyle,value:n,onChange:o,onready:i,placeholder:r})]})]})}},{key:"_buildSubmitItem",value:function(t){var e,n=this,r=t.title,o=t.value,i=t.onChange;return new E({children:[new E({style:ge.songAddTitleStyle,children:[new R(r)]}),new E({style:ge.songAddInputStyle,children:[new N({style:ge.songAddTextFieldStyle,value:o,onChange:i}),new D({onTap:(e=re(ee().mark((function t(){var e,r;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.playItem.author){t.next=3;break}return c.show({msg:"author cannot be empty"}),t.abrupt("return");case 3:if(n.playItem.name){t.next=6;break}return c.show({msg:"name cannot be empty"}),t.abrupt("return");case 6:if(n.playItem.imgUrl){t.next=9;break}return c.show({msg:"image url cannot be empty"}),t.abrupt("return");case 9:if(n.playItem.playUrl){t.next=12;break}return c.show({msg:"author cannot be empty"}),t.abrupt("return");case 12:return t.next=14,lt.getLocalPlaylist();case 14:e=t.sent,n.playItem.playId=e.length>0?e[e.length-1].playId+1:1,(r=lt.getLocalPlaylist()).push(n.playItem),lt.setLocalPlaylist(r),U.sendEvent(he,!1),U.sendEvent(ye);case 21:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)}),child:new E({style:ge.audioPickerContainerStyle,children:[new R("Submit")]})})]})]})}}]),n}(O);function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Ce(){Ce=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,o){var i=e&&e.prototype instanceof f?e:f,a=Object.create(i.prototype),u=new P(o||[]);return r(a,"_invoke",{value:k(t,n,u)}),a}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d={};function f(){}function h(){}function y(){}var p={};l(p,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(C([])));m&&m!==e&&n.call(m,i)&&(p=m);var g=y.prototype=f.prototype=Object.create(p);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(r,i,a,u){var l=s(t[r],t,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==Pe(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(d).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,u)}))}u(l.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function k(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var u=x(a,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=s(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=y,r(g,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:h,configurable:!0}),h.displayName=l(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(w.prototype),l(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),l(g,u,"Generator"),l(g,i,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=C,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function Le(t,e,n,r,o,i,a){try{var u=t[i](a),l=u.value}catch(t){return void n(t)}u.done?e(l):Promise.resolve(l).then(r,o)}function Te(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Le(i,r,o,a,u,"next",t)}function u(t){Le(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,De(r.key),r)}}function je(t,e,n){return e&&Ee(t.prototype,e),n&&Ee(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ie(){return Ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Me(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ie.apply(this,arguments)}function Ne(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Be(t,e)}function Be(t,e){return Be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Be(t,e)}function Ae(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Me(t);if(e){var o=Me(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Re(t)}(this,n)}}function Re(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Me(t){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Me(t)}function Fe(t,e,n){return(e=De(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function De(t){var e=function(t,e){if("object"!==Pe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Pe(e)?e:String(e)}var Ve="play_item_click",We="play_list_loaded",Ue=function(t){Ne(r,t);var e,n=Ae(r);function r(t){var e,o=t.onready,i=void 0===o?void 0:o,a=t.playListUrl,u=void 0===a?"":a;return Oe(this,r),Fe(Re(e=n.call(this,{styleName:"",onready:i})),"_onPlayItemClick",(function(t){e.playIndex=t;var n=e.playList[t];e.image.setImageUrl(n.imgUrl),e.title.setTitle(n.name+"-"+n.author),e.playListView&&e.playListView.resetPlayItem(t),e.audio.setPlayUrl(n.playUrl),e.audio.play(),e.playStatus=!0,e.audioButton&&e.audioButton.setPlayStatus(e.playStatus),e.lyrics&&e.lyrics.showLyrics(e._currentLyricUrl(),!0)})),Fe(Re(e),"_playListRefresh",Te(Ce().mark((function t(){var n;return Ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.playList.clear(),t.next=3,lt.getPlaylist(e.playListUrl);case 3:(n=t.sent).length>0&&e.playList.push.apply(e.playList,n),e.playIndex>e.playList.length-1&&(e.playIndex=e.playList.length-1),e.initProps.origin.setStateAsync({});case 7:case"end":return t.stop()}}),t)})))),Fe(Re(e),"_onSkinChangeRefresh",(function(){e.initProps.origin.setStateAsync({})})),Fe(Re(e),"_onPlay",(function(t){e.playList&&e.audio&&(e.audio.hasUrl()||!t?(e.playStatus=t,t&&e.audio.hasUrl()?e.audio.play():e.audio.pause()):e._onPlayItemClick(0))})),e.playListUrl=u,e.type=Dt.kSpaceEffect,e.playStatus=!1,e.volume=lt.getVolume(),e}return je(r,[{key:"initWidget",value:function(){this._loadPlaylist(),this.showSettings=!1,this.showSongAdd=!1,this.initProps={origin:this},U.addEvent(Ve,this._onPlayItemClick),U.addEvent(ye,this._playListRefresh),U.addEvent(pe,this._onSkinChangeRefresh)}},{key:"disposeWidget",value:function(){U.removeEvent(Ve,this._onPlayItemClick),U.removeEvent(ye,this._playListRefresh),U.removeEvent(pe,this._onSkinChangeRefresh),Ie(Me(r.prototype),"disposeWidget",this).call(this)}},{key:"_loadPlaylist",value:(e=Te(Ce().mark((function t(){return Ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.playIndex=0,t.next=3,lt.getPlaylist(this.playListUrl);case 3:this.playList=t.sent,this.playList.length>0&&U.sendEvent(We,this.playList);case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"_currentPlayUrl",value:function(){return this.playList&&0!=this.playList.length?this.playList[this.playIndex].playUrl:""}},{key:"_currentLyricUrl",value:function(){return this.playList&&0!=this.playList.length?this.playList[this.playIndex].lyricUrl:""}},{key:"_nextPlayIndex",value:function(){++this.playIndex>this.playList.length-1&&(this.playIndex=0)}},{key:"_buildEffectAudio",value:function(){var t=this,e=dt.instance().getSkin();return new D({onTap:function(){t.type=t.type>=Dt.kPillarEffect?Dt.kSpaceEffect:t.type+1,t.audio&&t.audio.setType(t.type)},child:new Vt({volume:this.volume,type:this.type,styleName:e.audioEffectContainer,oncanplay:function(){},onplay:function(){},onended:function(){console.log("on play completed"),lt.isTuneCirculation()||t._nextPlayIndex(),t._onPlayItemClick(t.playIndex)},onprogress:function(){},ontimeupdate:function(){t.audioProgress&&t.audio.currentTime()&&t.audio.duration()&&t.audioProgress.setProgress(t.audio.currentTime(),t.audio.duration()),t.lyrics&&t.audio&&t.lyrics.setTime(t._currentLyricUrl(),t.audio.currentTime())},onready:function(e){t.audio=e}})})}},{key:"_buildAudio",value:function(){var t=this;return new M({oncanplay:function(){},onplay:function(){},onended:function(){console.log("on play completed"),++t.playIndex>t.playList.length-1&&(t.playIndex=0),t._onPlayItemClick(t.playIndex)},onprogress:function(){},ontimeupdate:function(){t.audioProgress&&t.audio.currentTime()&&t.audio.duration()&&t.audioProgress.setProgress(t.audio.currentTime(),t.audio.duration()),t.lyrics&&t.audio&&t.lyrics.setTime(t._currentLyricUrl(),t.audio.currentTime())},onready:function(e){t.audio=e}})}},{key:"_buildAudioInfo",value:function(t){var e=this;return new E({styleName:t.audioHeader,children:[new He({onready:function(t){e.image=t}}),new Ge({widget:this._buildEffectAudio(),onready:function(t){e.title=t}}),new ze({onready:function(t){e.audioListButton=t},onListButtonClick:function(){e.playListView&&e.playListView.show(!e.playListView.isVisible())}}),new Ze({onLyricsButtonClick:function(){e.lyrics&&e.lyrics.showLyrics(e._currentLyricUrl())}}),new ve({onClick:function(){e.audioSettings&&(e.showSettings=!e.showSettings,e.audioSettings.showSettings(e.showSettings))}})]})}},{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new E({styleName:"",children:[new E({styleName:e.audioContainerBlink}),new E({styleName:e.audioPlayer,children:[this._buildAudioInfo(e),this._buildTools(e)]}),new Qe({playList:this.playList,playIndex:this.playIndex,onready:function(e){t.playListView=e}}),new tn({styleName:e.audioLyricsContainer,onready:function(e){t.lyrics=e}}),new we({show:this.showSettings,onready:function(e){t.audioSettings=e},onAddSong:function(){t.songAddWidget&&t.songAddWidget.show(!0)}}),new _e({showSongAdd:this.showSongAdd,onready:function(e){t.songAddWidget=e}})]})}},{key:"_buildTools",value:function(t){var e=this;return new E({styleName:t.audioBottom,children:[new Ye({onBack:function(){--e.playIndex<0&&(e.playIndex=0),e._onPlayItemClick(e.playIndex)}}),new Xe({status:this.playStatus,onClick:this._onPlay,onready:function(t){e.audioButton=t}}),new qe({onForward:function(){++e.playIndex>e.playList.length-1&&(e.playIndex=0),e._onPlayItemClick(e.playIndex)}}),new Je({onready:function(t){e.audioProgress=t},onAudioProgressUpdate:function(t){e.title&&e.title.updateProgressText(t)},onSeek:function(t){e.audio&&e.audio.duration()&&e.audio.seekTo(t)}}),new $e({volume:this.volume,onSetVolume:function(t){e.audio&&(console.log("audio.js---onSetVolume()---volume: "+t),e.audio.setVolume(t))}})]})}}]),r}(O),He=function(t){Ne(n,t);var e=Ae(n);function n(t){var r=t.onready,o=void 0===r?void 0:r;return Oe(this,n),e.call(this,{styleName:"",onready:o})}return je(n,[{key:"setImageUrl",value:function(t){this.image&&this.image.setImageUrl(t)}},{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new E({styleName:e.audioImageContainer,children:[new j({styleName:e.audioImage,onready:function(e){t.image=e}})]})}}]),n}(T),Ge=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.widget,i=t.onready,a=void 0===i?void 0:i;return Oe(this,n),(r=e.call(this,{styleName:"",onready:a})).title="",r.progressText="00:00-00:00",r.widget=o,r}return je(n,[{key:"setTitle",value:function(t){this.title&&this.title.setText(t)}},{key:"updateProgressText",value:function(t){this.audioProgressText&&this.audioProgressText.setText(t)}},{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new E({styleName:e.audioTitleContainer,children:[this.widget,new E({styleName:e.audioTitleText,children:[new R(this.title,(function(e){t.title=e}))]}),new E({styleName:e.audioProgressText,children:[new R(this.progressText,(function(e){t.audioProgressText=e}))]})]})}}]),n}(T),ze=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.onready,i=void 0===o?void 0:o,a=t.onListButtonClick,u=void 0===a?void 0:a;return Oe(this,n),(r=e.call(this,{styleName:"",onready:i})).onListButtonClick=u,r}return je(n,[{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new D({onTap:function(){t.onListButtonClick&&t.onListButtonClick()},child:new E({styleName:e.audioListButtonContainer,children:[new E({styleName:e.audioListButtonStyle}),new E({styleName:e.audioListButtonStyle}),new E({styleName:e.audioListButtonStyle})]})})}}]),n}(T),Ye=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.onBack,i=void 0===o?void 0:o;return Oe(this,n),(r=e.call(this,{styleName:""})).onBack=i,r}return je(n,[{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new D({onTap:function(){t.onBack&&t.onBack()},child:new E({styleName:e.audioButtonContainer,children:[new E({styleName:"".concat(e.audioButton," ").concat(e.audioBackFirst)}),new E({styleName:"".concat(e.audioButton," ").concat(e.audioBack)})]})})}}]),n}(T),Xe=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.status,i=void 0!==o&&o,a=t.onClick,u=void 0===a?void 0:a,l=t.onready;return Oe(this,n),(r=e.call(this,{styleName:"",onready:l})).onClick=u,r.status=i,r}return je(n,[{key:"setPlayStatus",value:function(t){var e=dt.instance().getSkin();this.status=t,this.buttonStatus.setStyleName("".concat(e.audioButton," ").concat(e.audioPlayPause))}},{key:"changeStyle",value:function(){var t=dt.instance().getSkin();this.status=!this.status,this.buttonStatus.setStyleName(this.status?"".concat(t.audioButton," ").concat(t.audioPlayPause):"".concat(t.audioButton," ").concat(t.audioPlayButton))}},{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new D({onTap:function(){t.changeStyle(),t.onClick(t.status)},child:new E({styleName:"".concat(e.audioButtonContainer," ").concat(e.audioLayout),children:[new E({styleName:this.status?"".concat(e.audioButton," ").concat(e.audioPlayPause):"".concat(e.audioButton," ").concat(e.audioPlayButton),onready:function(e){t.buttonStatus=e}})]})})}}]),n}(T),qe=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.onForward,i=void 0===o?void 0:o;return Oe(this,n),(r=e.call(this,{styleName:""})).onForward=i,r}return je(n,[{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new D({onTap:function(){t.onForward&&t.onForward()},child:new E({styleName:"".concat(e.audioButtonContainer," ").concat(e.audioLayout),children:[new E({styleName:"".concat(e.audioButton," ").concat(e.audioPlayForwardFirst)}),new E({styleName:"".concat(e.audioButton," ").concat(e.audioPlayForward)})]})})}}]),n}(T),Je=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.onready,i=void 0===o?void 0:o,a=t.onAudioProgressUpdate,u=void 0===a?void 0:a,l=t.onSeek,c=void 0===l?void 0:l;return Oe(this,n),Fe(Re(r=e.call(this,{styleName:"",onready:i})),"_onClick",(function(t){var e=r.audioProgressContainer.getBoundingClientRect();console.log("position"+JSON.stringify(e)+" event="+t.clientX),r.setProgress(t.clientX-e.left,e.right-e.left),r.onSeek&&r.onSeek((t.clientX-e.left)/(e.right-e.left))})),r.onAudioProgressUpdate=u,r.onSeek=c,r}return je(n,[{key:"setProgress",value:function(t,e){this.progress&&(this.progress.setWidth((t/e*100).toFixed(2)+"%"),this.onAudioProgressUpdate&&this.onAudioProgressUpdate(s.timeFormat(t)+"-"+s.timeFormat(e)))}},{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new E({styleName:e.audioProgressCtrl,children:[new D({onTap:this._onClick,child:new E({styleName:e.audioProgressContainer,children:[new E({styleName:e.audioProgress,onready:function(e){t.progress=e}})],onready:function(e){t.audioProgressContainer=e}})})]})}}]),n}(T),$e=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.volume,i=void 0===o?1:o,a=t.onSetVolume,u=void 0===a?void 0:a;return Oe(this,n),Fe(Re(r=e.call(this,{styleName:""})),"_onClick",(function(t){if(r.audioVolumeContainer&&r.audioVolumeProgress&&r.audioVolumeBar){var e=r.audioVolumeContainer.getBoundingClientRect();if(e){var n=e.right-e.left,o=t.clientX-e.left;o<0&&(o=0),t.clientX-e.left>n&&(o=n),console.log("position"+JSON.stringify(e)+" event="+t.clientX),r.volume=o/n,r._setVolume()}}})),r.mute=0==i,r.volume=i,r.onSetVolume=u,r}return je(n,[{key:"initWidget",value:function(){var t=this;s.asyncTask({macroTask:function(){t._setVolume(t.volume)}})}},{key:"_setVolume",value:function(){var t=this.audioVolumeContainer.getBoundingClientRect();if(t){var e=t.right-t.left,n=this.volume,r=n*e;this.audioVolumeProgress.setWidth((100*n).toFixed(2)+"%"),console.log("audioVolumeBar width="+this.audioVolumeBar.offsetWidth()),this.audioVolumeBar.setLeft((r-this.audioVolumeBar.offsetWidth()<0?0:r-this.audioVolumeBar.offsetWidth())+"px"),r>0&&(this.mute=!1),this._setMuteStyle(),this.onSetVolume(n),lt.setVolume(n)}}},{key:"_setMute",value:function(){this.audioVolumeProgress.setWidth("0px"),this.audioVolumeBar.setLeft("0px"),this._setMuteStyle(),this.onSetVolume(0)}},{key:"_setMuteStyle",value:function(){this.muteRef&&this.muteRef.setStyleName(this.mute?"audio-volume-mute":"audio-widget-hide")}},{key:"_buildVolumeIcon",value:function(t){var e=this;return new D({onTap:function(){e.mute=!e.mute,e.mute?e._setMute():e._setVolume()},child:new E({styleName:"audio-volume-left-container",children:[new E({styleName:t.audioVolumeIconContainer,children:[new E({styleName:"".concat(t.audioButton," ").concat(t.audioVolumeIconFirst)}),new E({styleName:"".concat(t.audioButton," ").concat(t.audioVolumeIcon)})]}),new E({styleName:this.mute?"audio-volume-mute":"audio-widget-hide",onready:function(t){e.muteRef=t}})]})})}},{key:"_buildVolumeProgress",value:function(t){var e=this;return new D({onTap:this._onClick,child:new E({styleName:t.audioVolumeView,children:[new E({styleName:t.audioVolumeProgress,onready:function(t){e.audioVolumeProgress=t}}),new E({styleName:t.audioVolumeBar,onready:function(t){e.audioVolumeBar=t}})],onready:function(t){e.audioVolumeContainer=t}})})}},{key:"build",value:function(){var t=dt.instance().getSkin();return new E({styleName:t.audioVolumeContainer,children:[this._buildVolumeIcon(t),this._buildVolumeProgress(t)]})}}]),n}(T),Ke=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.item,i=t.index,a=t.focus,u=void 0!==a&&a,l=t.onready,c=void 0===l?void 0:l;return Oe(this,n),(r=e.call(this,{styleName:"",onready:c})).item=o,r.index=i,r.focus=u,r}return je(n,[{key:"setItemStatus",value:function(){this.audioPlayItemName&&this.audioPlayItemName.setFocus(!0)}},{key:"resetItemStatus",value:function(){this.audioPlayItemName&&this.audioPlayItemName.setFocus(!1)}},{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new D({onTap:function(){U.sendEvent(Ve,t.index)},child:new E({styleName:this.index%2==0?e.audioPlaylistItem:e.audioPlaylistEvenItem,children:[new E({styleName:e.audioItemIndex,children:[new R("".concat(this.item.local?"L":"").concat(this.item.playId,". "))]}),new Xt({text:this.item.name,focus:this.focus,onready:function(e){t.audioPlayItemName=e}}),new E({styleName:e.audioItemAuthor,children:[new R(this.item.author)]}),new E({styleName:"audio-playlist-item-hover"})]})})}}]),n}(T),Qe=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.playIndex,i=void 0===o?0:o,a=t.playList,u=void 0===a?void 0:a,l=t.onready,c=void 0===l?void 0:l;return Oe(this,n),Fe(Re(r=e.call(this,{styleName:"",onready:c})),"_onPlayListLoaded",(function(t){r.setStateAsync({playList:t},(function(){U.sendEvent(Ve,r.focusIndex)}))})),r.focusIndex=i,r.state={playList:u},r}return je(n,[{key:"initWidget",value:function(){U.addEvent(We,this._onPlayListLoaded),this.visible=!0,this.initProps={origin:this}}},{key:"disposeWidget",value:function(){U.removeEvent(We,this._onPlayListLoaded)}},{key:"resetPlayItem",value:function(t){if(this.initProps.audioPlaylistView){var e=this.initProps.audioPlaylistView.children;e[this.focusIndex].resetItemStatus(),this.focusIndex=t,e[this.focusIndex].setItemStatus()}}},{key:"show",value:function(t){if(this.visible=t,this.initProps.audioPlaylistContainer){var e=dt.instance().getSkin();this.initProps.audioPlaylistContainer.setStyleName(t?"".concat(e.audioPlaylistShow," ").concat(e.audioPlaylistRoot):e.audioPlaylistContainerHide)}}},{key:"isVisible",value:function(){return this.visible}},{key:"build",value:function(){var t=this,e=[];this.state.playList&&this.state.playList.forEach((function(n,r){e.push(new Ke({item:n,index:r,focus:t.focusIndex==r}))}));var n=dt.instance().getSkin();return new E({styleName:n.audioPlaylistRoot,children:[new E({styleName:n.audioPlaylistContainer,children:e,onready:function(e){t.initProps.audioPlaylistView=e}}),new E({styleName:n.audioShadowTop}),new E({styleName:n.audioShadowBottom})],onready:function(e){t.initProps.audioPlaylistContainer=e}})}}]),n}(O),Ze=function(t){Ne(n,t);var e=Ae(n);function n(t){var r,o=t.onLyricsButtonClick,i=void 0===o?void 0:o;return Oe(this,n),(r=e.call(this,{styleName:""})).onLyricsButtonClick=i,r}return je(n,[{key:"build",value:function(){var t=this,e=dt.instance().getSkin();return new D({onTap:function(){t.onLyricsButtonClick&&t.onLyricsButtonClick()},child:new E({styleName:e.audioLyricButtonContainer,children:[new R("")]})})}}]),n}(T),tn=function(t){Ne(r,t);var e,n=Ae(r);function r(t){var e=t.styleName,o=void 0===e?"":e,i=t.onready,a=void 0===i?void 0:i;return Oe(this,r),n.call(this,{styleName:o,onready:a})}return je(r,[{key:"initWidget",value:function(){this.show=!1,this.lyricsMap={},this.focusIndex=0,this.showBuild=!1,this.initProps={}}},{key:"_parseLyric",value:function(t){var e,n=[],r=null!==(e=t.split("\n"))&&void 0!==e?e:[];if(0==r.length)return n;for(var o=/\[\d{2}:\d{2}.\d{2}\]/g;r.length>0&&!o.test(r[0]);)r=r.slice(1);return 0===r[r.length-1].length&&r.pop(),r.forEach((function(t){var e=t.match(o),r=t.replace(o,"");e.forEach((function(t){var e=t.slice(1,-1).split(":");n.push({time:60*parseInt(e[0],10)+parseFloat(e[1]),lyric:r})}))})),n.sort((function(t,e){return t.time-e.time})),n}},{key:"showLyrics",value:(e=Te(Ce().mark((function t(e){var n,r,o=arguments;return Ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(o.length>1&&void 0!==o[1]&&o[1])){t.next=6;break}if(this.show){t.next=4;break}return t.abrupt("return");case 4:t.next=7;break;case 6:this.show=!this.show;case 7:if(this.show&&e){t.next=11;break}return this.lyrics=null,this.setStateAsync({}),t.abrupt("return");case 11:if(n=this.lyricsMap[e]){t.next=17;break}return t.next=15,J.fetchPromise({url:e,headers:Fe({},at,"none"),method:J.HttpMethod.get,responseType:"text"});case 15:"ok"==(r=t.sent).status&&(console.log("lyric data = ",r),n=this._parseLyric(r.data),this.lyricsMap[e]=n);case 17:this.lyrics=n,this.showBuild=this.show,this.setStateAsync({});case 20:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"setTime",value:function(t,e){var n=this.lyricsMap[t];if(n)for(var r=n.length-1;r>=0;r--)if(e>n[r].time){this._setFocus(r);break}}},{key:"_setFocus",value:function(t){this.focusIndex!=t&&(this.focusIndex=t,this.show&&(this.initProps.container&&this.initProps.container.scrollTo(s.remToPx(2.2)*t),this.setStateAsync({})))}},{key:"_buildItemListContainer",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=n.length>0;return new E({onready:function(t){e.initProps.container=t},styleName:r?t.audioLyricsContainer:t.audioNoLyricTip,children:r?n:[new R("No Lyric")]})}},{key:"build",value:function(){var t=this;if(!this.show)return new E({});var e=dt.instance().getSkin(),n=[];this.lyrics&&this.lyrics.length>0&&this.lyrics.forEach((function(r,o){n.push(t._buildLyricItem(r.lyric,o,e))}));var r=this.showBuild;return this.showBuild=!1,new E({styleName:r?"".concat(e.audioLyricShow," ").concat(e.audioLyricRoot):e.audioLyricRoot,children:[this._buildItemListContainer(e,n),new E({styleName:e.audioShadowTop}),new E({styleName:e.audioShadowBottom})]})}},{key:"_buildLyricItem",value:function(t,e,n){return new E({styleName:e==this.focusIndex?n.audioLyricItemFocus:n.audioLyricItem,children:[new R(t)]})}}]),r}(O);function en(t){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},en(t)}function nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ln(r.key),r)}}function rn(t,e){return rn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},rn(t,e)}function on(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function an(t){return an=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},an(t)}function un(t,e,n){return(e=ln(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ln(t){var e=function(t,e){if("object"!==en(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==en(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===en(e)?e:String(e)}var cn={login:{path:"/boyiaweb/index/login",title:"login",page:function(){return new E({styleName:""})}},home:{path:"/boyiaweb/index/home",title:"home",page:function(){return new sn({styleName:""})}}},sn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rn(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=an(r);if(o){var n=an(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===en(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return on(t)}(this,t)});function a(t){var e,n=t.styleName,r=void 0===n?"":n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),un(on(e=i.call(this,{styleName:r})),"onMouseDown",(function(t){e.moving=!0,e.playerContainer&&(e.playerLeft=t.clientX,e.playerTop=t.clientY,e.playerOffsetLeft=e.playerContainer.offsetLeft(),e.playerOffsetTop=e.playerContainer.offsetTop(),console.log("playerOffsetLeft="+e.playerContainer.offsetLeft()+" playerOffsetLeft"+e.playerContainer.offsetTop()),e.playerContainer.setCursor("move"))})),un(on(e),"_onMouseMove",(function(t){if(e.playerContainer&&e.moving){console.log("playerLeft="+e.playerLeft+" playerTop"+e.playerTop);var n=t.clientX-(e.playerLeft-e.playerOffsetLeft),r=t.clientY-(e.playerTop-e.playerOffsetTop);console.log("index.js---onMouseMove---left: "+n+" top: "+r),e.playerContainer.setLeft(n+"px"),e.playerContainer.setTop(r+"px")}})),un(on(e),"onMouseUp",(function(t){console.log("index.js---onMouseUp"),e.moving=!1,e.playerContainer&&e.playerContainer.setCursor("default")})),un(on(e),"_onTouchStart",(function(t){e.moving=!0,e.playerContainer&&(e.playerLeft=t.touches[0].clientX,e.playerTop=t.touches[0].clientY,e.playerOffsetLeft=e.playerContainer.offsetLeft(),e.playerOffsetTop=e.playerContainer.offsetTop(),console.log("playerOffsetLeft="+e.playerContainer.offsetLeft()+" playerOffsetLeft"+e.playerContainer.offsetTop()),e.playerContainer.setCursor("move"))})),un(on(e),"_onTouchMove",(function(t){if(e.playerContainer&&e.moving){console.log("playerLeft="+e.playerLeft+" playerTop"+e.playerTop);var n=t.touches[0].clientX-(e.playerLeft-e.playerOffsetLeft),r=t.touches[0].clientY-(e.playerTop-e.playerOffsetTop);console.log("index.js---onMouseMove---left: "+n+" top: "+r),e.playerContainer.setLeft(n+"px"),e.playerContainer.setTop(r+"px")}})),window.onmousemove=e._onMouseMove,window.ontouchmove=e._onTouchMove,e.playerLeft=-1,e.playerTop=-1,e.playerOffsetLeft=-1,e.playerOffsetTop=-1,e}return e=a,(n=[{key:"_buildTitle",value:function(){return new E({styleName:"desktop-title",children:[new R("Boyia work desktop")]})}},{key:"_buildSetting",value:function(){var t=this;return new E({styleName:"setting-panel",children:[this._buildTitle(),new E({styleName:"setting-item",children:[new E({styleName:"setting-title",children:[new R("Skin Change")]}),new Zt({id:"oneOpen",theme:"bui-theme-blue",onSwitchChecked:function(e){e?dt.instance().setSkin("default"):dt.instance().setSkin("black"),t.audio&&t.audio.setState({})}})]})]})}},{key:"build",value:function(){var t=this;return new E({styleName:"page-main",children:[this._buildSetting(),new D({onTouchStart:this._onTouchStart,onTouchEnd:this.onMouseUp,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,child:new E({styleName:"index-audio-player",children:[new Ue({onready:function(e){t.audio=e},playListUrl:kPlaylistUrl})],onready:function(e){t.playerContainer=e}})})]})}}])&&nn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(O);$(document).ready((function(){W.init(),W.push(cn.home)}))})();